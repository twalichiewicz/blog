import Component from"../../utilities/base-component.js";export default class Button extends Component{static defaults={variant:"default",size:"md",ripple:!0,loadingText:"Loading...",disableOnClick:!1,hapticFeedback:!0,soundEffect:!0};static componentName="button";setupDOM(){super.setupDOM(),this.addClass(this.element,"btn"),this.updateVariant(this.options.variant),this.updateSize(this.options.size),this.options.ripple&&!this.element.disabled&&this.setupRipple(),this._originalText=this.element.textContent,this._icon=this.find(".btn__icon"),this.find(".btn__spinner")||(this._spinner=document.createElement("span"),this._spinner.className="btn__spinner",this._spinner.setAttribute("aria-hidden","true"),this.element.appendChild(this._spinner))}bindEvents(){super.bindEvents(),this.addEventListener(this.element,"click",this.handleClick.bind(this)),this.addEventListener(this.element,"keydown",this.handleKeydown.bind(this)),"ontouchstart"in window&&(this.addEventListener(this.element,"touchstart",this.handleTouchStart.bind(this),{passive:!0}),this.addEventListener(this.element,"touchend",this.handleTouchEnd.bind(this)))}handleClick(t){this.element.disabled||this.hasClass(this.element,"is-loading")?t.preventDefault():(this.options.soundEffect&&window.soundEffects?.playButtonPress&&window.soundEffects.playButtonPress(),this.options.disableOnClick&&this.disable(),this.emit("btn:click",{button:this}))}handleKeydown(t){"Enter"!==t.key&&" "!==t.key||"A"!==this.element.tagName||(t.preventDefault(),this.element.click())}handleTouchStart(t){this.addClass(this.element,"is-pressed"),this.options.hapticFeedback&&window.navigator.vibrate&&window.navigator.vibrate(10)}handleTouchEnd(t){this.removeClass(this.element,"is-pressed")}setupRipple(){this.addClass(this.element,"btn--ripple"),this.addEventListener(this.element,"click",t=>{const e=document.createElement("span");e.className="btn__ripple";const i=this.element.getBoundingClientRect(),s=Math.max(i.width,i.height),n=t.clientX-i.left-s/2,a=t.clientY-i.top-s/2;e.style.width=e.style.height=s+"px",e.style.left=n+"px",e.style.top=a+"px",this.element.appendChild(e),setTimeout(()=>e.remove(),600)})}updateVariant(t){const e=this.getAttribute(this.element,"data-variant");e&&this.removeClass(this.element,`btn--${e}`),this.addClass(this.element,`btn--${t}`),this.setAttribute(this.element,"data-variant",t)}updateSize(t){const e=this.getAttribute(this.element,"data-size");e&&this.removeClass(this.element,`btn--${e}`),this.addClass(this.element,`btn--${t}`),this.setAttribute(this.element,"data-size",t)}setLoading(t,e){this.toggleClass(this.element,"is-loading",t),this.element.disabled=t,this.setAttribute(this.element,"aria-busy",t?"true":"false");const i=this.find(".btn__text")||this.element;t?(this._currentText||(this._currentText=i.textContent),i.textContent=e||this.options.loadingText,this.emit("btn:loading:start",{button:this})):(this._currentText&&(i.textContent=this._currentText,this._currentText=null),this.emit("btn:loading:end",{button:this}))}enable(){this.element.disabled=!1,this.removeClass(this.element,"is-disabled"),this.removeAttribute(this.element,"aria-disabled")}disable(){this.element.disabled=!0,this.addClass(this.element,"is-disabled"),this.setAttribute(this.element,"aria-disabled","true")}toggle(t){(void 0!==t?t:!this.element.disabled)?this.disable():this.enable()}focus(){this.element.focus()}blur(){this.element.blur()}setText(t){(this.find(".btn__text")||this.element).textContent=t,this._originalText=t}setIcon(t,e="start"){const i=this.find(".btn__icon");if(i&&i.remove(),!t)return;const s=document.createElement("span");s.className=`btn__icon btn__icon--${e}`,s.innerHTML=t;const n=this.find(".btn__text");n?"start"===e?this.element.insertBefore(s,n):this.element.insertBefore(s,n.nextSibling):"start"===e?this.element.insertBefore(s,this.element.firstChild):this.element.appendChild(s)}click(){this.element.click()}beforeDestroy(){this.findAll(".btn__ripple").forEach(t=>t.remove())}}"undefined"!=typeof document&&document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll('[data-component="button"]').forEach(t=>{const e=t.dataset.buttonOptions?JSON.parse(t.dataset.buttonOptions):{};new Button(t,e)})});
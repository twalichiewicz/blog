class PrototypeSandbox{constructor(t,e={}){this.element=t,this.options={autoStart:!1,showControls:!0,isolated:!0,theme:"youtube",aspectRatio:"16/9",...e},this.init()}init(){this.createSandbox(),this.options.isolated&&this.setupIsolation(),this.options.showControls&&this.createControls(),this.options.autoStart||this.createPlayButton()}createSandbox(){const t=this.element.innerHTML;this.element.innerHTML=`\n      <div class="prototype-sandbox" data-theme="${this.options.theme}">\n        <div class="sandbox-preview">\n          <div class="sandbox-content" style="aspect-ratio: ${this.options.aspectRatio}">\n            ${t}\n          </div>\n          <div class="sandbox-overlay"></div>\n        </div>\n      </div>\n    `,this.sandbox=this.element.querySelector(".prototype-sandbox"),this.content=this.element.querySelector(".sandbox-content"),this.overlay=this.element.querySelector(".sandbox-overlay")}setupIsolation(){this.sandbox.addEventListener("click",t=>{t.target.closest('a[href^="http"]')||t.stopPropagation()}),this.content.addEventListener("wheel",t=>{const{scrollTop:e,scrollHeight:n,clientHeight:s}=this.content;n>s&&((0===e&&t.deltaY<0||e+s>=n&&t.deltaY>0)&&t.preventDefault(),t.stopPropagation())}),this.sandbox.addEventListener("keydown",t=>{if("Tab"===t.key){const e=this.sandbox.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),n=e[0],s=e[e.length-1];t.shiftKey&&document.activeElement===n?(t.preventDefault(),s.focus()):t.shiftKey||document.activeElement!==s||(t.preventDefault(),n.focus())}})}createPlayButton(){const t=document.createElement("button");t.className="sandbox-play-button",t.innerHTML='\n      <svg viewBox="0 0 24 24" width="48" height="48">\n        <path fill="currentColor" d="M8 5v14l11-7z"/>\n      </svg>\n      <span>Start Interactive Demo</span>\n    ',t.addEventListener("click",()=>{this.start()}),this.overlay.appendChild(t)}createControls(){const t=document.createElement("div");t.className="sandbox-controls",t.innerHTML='\n      <button class="sandbox-reset" title="Reset demo">\n        <svg viewBox="0 0 24 24" width="20" height="20">\n          <path fill="currentColor" d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/>\n        </svg>\n      </button>\n      <button class="sandbox-fullscreen" title="Fullscreen">\n        <svg viewBox="0 0 24 24" width="20" height="20">\n          <path fill="currentColor" d="M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z"/>\n        </svg>\n      </button>\n    ',t.querySelector(".sandbox-reset").addEventListener("click",()=>{this.reset()}),t.querySelector(".sandbox-fullscreen").addEventListener("click",()=>{this.toggleFullscreen()}),this.sandbox.appendChild(t)}start(){this.sandbox.classList.add("active"),this.overlay.style.display="none",this.element.dispatchEvent(new CustomEvent("prototypeStart",{detail:{sandbox:this}}))}reset(){const t=new CustomEvent("prototypeReset",{detail:{sandbox:this}});if(this.element.dispatchEvent(t),!t.defaultPrevented){const t=this.content.innerHTML;this.content.innerHTML="",setTimeout(()=>{this.content.innerHTML=t,this.start()},100)}}toggleFullscreen(){this.sandbox.classList.toggle("fullscreen"),document.body.classList.toggle("prototype-fullscreen-active"),this.sandbox.classList.contains("fullscreen")?document.addEventListener("keydown",this.handleEscape):document.removeEventListener("keydown",this.handleEscape)}handleEscape=t=>{"Escape"===t.key&&this.toggleFullscreen()};static autoInit(){document.querySelectorAll("[data-prototype-sandbox]").forEach(t=>{if(!t.classList.contains("prototype-initialized")){const e=JSON.parse(t.dataset.prototypeSandbox||"{}");new PrototypeSandbox(t,e),t.classList.add("prototype-initialized")}})}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",PrototypeSandbox.autoInit):PrototypeSandbox.autoInit(),window.PrototypeSandbox=PrototypeSandbox;
<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Sound Service Test</title><style>body{font-family:system-ui,-apple-system,sans-serif;max-width:800px;margin:2rem auto;padding:0 1rem;line-height:1.6}.test-section{background:#f5f5f5;padding:1rem;margin:1rem 0;border-radius:8px}button{padding:.5rem 1rem;margin:.25rem;border:none;background:#06c;color:#fff;border-radius:4px;cursor:pointer}button:hover{background:#0052a3}button:disabled{background:#ccc;cursor:not-allowed}.status{padding:.5rem;margin:.5rem 0;border-radius:4px}.status.success{background:#d4edda;color:#155724}.status.error{background:#f8d7da;color:#721c24}.status.info{background:#d1ecf1;color:#0c5460}input[type=range]{width:200px;vertical-align:middle}.controls{display:flex;align-items:center;gap:1rem;flex-wrap:wrap}pre{background:#f8f8f8;padding:1rem;overflow-x:auto;border-radius:4px}</style></head><body><h1>Sound Service Test Suite</h1><div class="test-section"><h2>Status</h2><div id="status" class="status info">Click any button to test autoplay detection</div><pre id="debug-info">Loading...</pre></div><div class="test-section"><h2>Core Functionality Tests</h2><div class="controls"><button id="test-init">Test Initialization</button> <button id="test-formats">Test Format Detection</button> <button id="test-registry">Test Registry</button> <button id="test-play">Test Play Sound</button> <button id="test-preload">Test Preload</button> <button id="test-categories">Test Categories</button></div></div><div class="test-section"><h2>Sound Controls</h2><div class="controls"><label><input type="checkbox" id="sound-enabled" checked="checked"> Enable Sounds</label> <label>Volume: <input type="range" id="volume" min="0" max="100" value="50"> <span id="volume-display">50%</span></label></div></div><div class="test-section"><h2>Built-in Sounds</h2><div class="controls"><button class="play-sound" data-sound="button">Button Click</button> <button class="play-sound" data-sound="toggle">Toggle</button> <button class="play-sound" data-sound="smallClick">Small Click</button> <button class="play-sound" data-sound="slider">Slider</button> <button class="play-sound" data-sound="book">Book</button></div></div><div class="test-section"><h2>Test Results</h2><div id="results"></div></div><script type="module">import SoundService from"./sound-service.js";const soundService=new SoundService;window.testSoundService=soundService;const status=document.getElementById("status"),debugInfo=document.getElementById("debug-info"),results=document.getElementById("results"),volumeSlider=document.getElementById("volume"),volumeDisplay=document.getElementById("volume-display"),enabledCheckbox=document.getElementById("sound-enabled");function updateDebugInfo(){debugInfo.textContent=JSON.stringify({enabled:soundService.enabled,volume:soundService.volume,autoplayAllowed:soundService.autoplayAllowed,cachedSounds:soundService.sounds.size,supportedFormats:soundService.supportedFormats,pendingSounds:soundService.pendingSounds.length},null,2)}function addResult(e,t,n){const s=document.createElement("div");s.className="status "+(t?"success":"error"),s.textContent=`${e}: ${n}`,results.appendChild(s)}document.getElementById("test-init").addEventListener("click",()=>{try{addResult("Initialization",!0,"Service initialized successfully"),addResult("Singleton",soundService===new SoundService,"Singleton pattern working"),addResult("Global Access",window.soundService===soundService,"Global access available"),updateDebugInfo()}catch(e){addResult("Initialization",!1,e.message)}}),document.getElementById("test-formats").addEventListener("click",()=>{try{const e=soundService.supportedFormats;let t=[];for(const[n,s]of Object.entries(e))s&&t.push(n);addResult("Format Detection",!0,`Supported: ${t.join(", ")}`),updateDebugInfo()}catch(e){addResult("Format Detection",!1,e.message)}}),document.getElementById("test-registry").addEventListener("click",()=>{try{const e=soundService.getAvailableSounds();addResult("Registry",!0,`Available sounds: ${e.length}`),addResult("Sound List",!0,e.join(", ")),soundService.registerSound("test-dynamic",{name:"Dynamic Test Sound",url:"data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQAAAAA=",volume:.3});addResult("Dynamic Registration",soundService.getAvailableSounds().includes("test-dynamic"),"Successfully registered new sound"),updateDebugInfo()}catch(e){addResult("Registry",!1,e.message)}}),document.getElementById("test-play").addEventListener("click",async()=>{try{const e="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEARKwAAIhYAQACABAAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBTGHy+/msjMFHm7A7+aeSAoQVqzn8LFzHwUuhM/y55NWCg9Qst3m";await soundService.play("test",{source:e}),addResult("Play Sound",!0,"Sound played successfully"),!1===soundService.autoplayAllowed?(status.textContent="Autoplay blocked - sounds require user interaction",status.className="status info"):(status.textContent="Autoplay allowed - sounds working normally",status.className="status success"),updateDebugInfo()}catch(e){addResult("Play Sound",!1,e.message)}}),document.getElementById("test-preload").addEventListener("click",async()=>{try{await soundService.preload(["button","toggle"]),addResult("Preload",!0,`Preloaded sounds, cache size: ${soundService.sounds.size}`),updateDebugInfo()}catch(e){addResult("Preload",!1,e.message)}}),document.getElementById("test-categories").addEventListener("click",()=>{try{const e=soundService.getSoundsByCategory("ui"),t=soundService.getSoundsByCategory("navigation"),n=soundService.getSoundsByCategory("ambient");addResult("Categories",!0,`UI: ${Object.keys(e).length}, Navigation: ${Object.keys(t).length}, Ambient: ${Object.keys(n).length}`);const s=Object.keys(e)[0];s&&(soundService.play(s),addResult("Category Play",!0,`Played ${s} from UI category`)),updateDebugInfo()}catch(e){addResult("Categories",!1,e.message)}}),volumeSlider.addEventListener("input",e=>{const t=e.target.value/100;soundService.setVolume(t),volumeDisplay.textContent=`${e.target.value}%`,updateDebugInfo()}),enabledCheckbox.addEventListener("change",e=>{soundService.setEnabled(e.target.checked),updateDebugInfo()}),document.querySelectorAll(".play-sound").forEach(e=>{e.addEventListener("click",async e=>{const t=e.target.dataset.sound;try{await soundService.play(t),e.target.style.background="#28a745",setTimeout(()=>{e.target.style.background=""},200)}catch(n){e.target.style.background="#dc3545",console.error(`Failed to play ${t}:`,n)}})}),updateDebugInfo(),volumeSlider.value=100*soundService.volume,volumeDisplay.textContent=`${Math.round(100*soundService.volume)}%`,enabledCheckbox.checked=soundService.enabled,setInterval(updateDebugInfo,1e3)</script></body></html>
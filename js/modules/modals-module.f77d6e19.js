!function(t){"use strict";const e=new class{constructor(){this.activeModals=new Set,this.keyboardListeners=new Map,this.initialized=!1}init(){this.initialized||(this.setupBackdropListeners(),this.initialized=!0,t.events.emit("modals:initialized"))}setupBackdropListeners(){document.addEventListener("click",t=>{if(t.target.classList.contains("modal")&&t.target===t.currentTarget){const e=t.target.id;"impact-modal"===e?this.closeImpact():"contact-modal"===e&&this.closeContact()}})}openModal(e,o={}){const s=document.getElementById(e);if(!s)return;document.body.style.overflow="hidden",s.style.display="flex",this.activeModals.add(e);const i=t=>{"Escape"===t.key&&this.closeModal(e)};this.keyboardListeners.set(e,i),document.addEventListener("keydown",i),setTimeout(()=>{s.classList.add("active")},10),t.utils.sound&&t.utils.sound.isEnabled()&&t.utils.sound.playSmallClick(),t.events.emit("modal:opened",{modalId:e})}closeModal(e){const o=document.getElementById(e);if(!o)return;o.classList.remove("active");const s=this.keyboardListeners.get(e);s&&(document.removeEventListener("keydown",s),this.keyboardListeners.delete(e)),setTimeout(()=>{o.style.display="none",this.activeModals.delete(e),0===this.activeModals.size&&(document.body.style.overflow="")},300),t.events.emit("modal:closed",{modalId:e})}openImpact(t){t&&t.stopPropagation(),this.openModal("impact-modal")}closeImpact(){this.closeModal("impact-modal")}openContact(t){t&&t.stopPropagation(),this.openModal("contact-modal")}closeContact(){this.closeModal("contact-modal")}isModalOpen(t){return this.activeModals.has(t)}getActiveModals(){return Array.from(this.activeModals)}closeAll(){this.activeModals.forEach(t=>{this.closeModal(t)})}};t.ui.modals=e,t.registerModule("modals",e),t.ui.modals.openImpact=e.openImpact.bind(e),t.ui.modals.closeImpact=e.closeImpact.bind(e),t.ui.modals.openContact=e.openContact.bind(e),t.ui.modals.closeContact=e.closeContact.bind(e)}(window.SD||(window.SD={}));
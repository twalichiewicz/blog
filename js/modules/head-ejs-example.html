<h1 id="How-to-Update-head-ejs-for-Module-System"><a href="#How-to-Update-head-ejs-for-Module-System" class="headerlink" title="How to Update head.ejs for Module System"></a>How to Update head.ejs for Module System</h1><p>This document shows how to update the head.ejs file to use the new module loader system.</p>
<h2 id="Current-Script-Loading-Lines-157-167"><a href="#Current-Script-Loading-Lines-157-167" class="headerlink" title="Current Script Loading (Lines 157-167)"></a>Current Script Loading (Lines 157-167)</h2><pre><code class="language-html">&lt;!-- Core Scripts --&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/main.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/components/HomeVisuals.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/mobile-tabs.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/carousel.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/animations.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/project-tabs.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/project-summary.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/scroll.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/sound-effects.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/external-links.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
</code></pre>
<h2 id="New-Module-Loader-Approach"><a href="#New-Module-Loader-Approach" class="headerlink" title="New Module Loader Approach"></a>New Module Loader Approach</h2><p>Replace the above lines with:</p>
<pre><code class="language-html">&lt;!-- San Diego Module System --&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/module-loader.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;

&lt;!-- Keep these module scripts that haven&#39;t been converted yet --&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/components/HomeVisuals.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/carousel.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/animations.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
</code></pre>
<h2 id="Scripts-to-Remove-from-Other-Templates"><a href="#Scripts-to-Remove-from-Other-Templates" class="headerlink" title="Scripts to Remove from Other Templates"></a>Scripts to Remove from Other Templates</h2><h3 id="In-layout-ejs"><a href="#In-layout-ejs" class="headerlink" title="In layout.ejs:"></a>In layout.ejs:</h3><p>Remove these duplicate scripts:</p>
<ul>
<li><code>/js/device-detection.js</code></li>
<li><code>/js/main.js</code> (duplicate)</li>
<li><code>/js/mobile-tabs.js</code> (duplicate) </li>
<li><code>/js/sound-effects.js</code> (duplicate)</li>
</ul>
<h3 id="In-index-ejs"><a href="#In-index-ejs" class="headerlink" title="In index.ejs:"></a>In index.ejs:</h3><p>Update these scripts:</p>
<ul>
<li><code>/js/blog.js</code> - Now loaded as part of the module system</li>
<li><code>/js/anchor-links-simple.js</code> - Now part of navigation module</li>
</ul>
<p>Keep these for now:</p>
<ul>
<li><code>/js/blog-init.js</code> - Needs to be converted</li>
<li><code>/js/visibility-debug.js</code> - Optional debug tool</li>
</ul>
<h2 id="Benefits"><a href="#Benefits" class="headerlink" title="Benefits"></a>Benefits</h2><ol>
<li><strong>Single Entry Point</strong>: Only one main script to load</li>
<li><strong>No Duplicates</strong>: Scripts are loaded once in the correct order</li>
<li><strong>Automatic Initialization</strong>: Modules initialize themselves</li>
<li><strong>Better Performance</strong>: Scripts load in parallel but initialize in order</li>
<li><strong>Easier Maintenance</strong>: Add&#x2F;remove modules in one place</li>
</ol>
<h2 id="Migration-Checklist"><a href="#Migration-Checklist" class="headerlink" title="Migration Checklist"></a>Migration Checklist</h2><ul>
<li><input disabled="" type="checkbox"> Update head.ejs to use module-loader.js</li>
<li><input disabled="" type="checkbox"> Remove duplicate script tags from layout.ejs</li>
<li><input disabled="" type="checkbox"> Update index.ejs to remove migrated scripts</li>
<li><input disabled="" type="checkbox"> Test that all functionality still works</li>
<li><input disabled="" type="checkbox"> Convert remaining module scripts (HomeVisuals, carousel, animations)</li>
<li><input disabled="" type="checkbox"> Remove legacy script includes once everything is converted</li>
</ul>
<h2 id="Example-Full-Update"><a href="#Example-Full-Update" class="headerlink" title="Example Full Update"></a>Example Full Update</h2><p>Hereâ€™s what the script section in head.ejs should look like after migration:</p>
<pre><code class="language-html">&lt;!-- Core Module System --&gt;
&lt;script src=&quot;&lt;%- url_for(&#39;js/module-loader.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;

&lt;!-- Temporary: Scripts not yet converted to modules --&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/components/HomeVisuals.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/carousel.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;
&lt;script type=&quot;module&quot; src=&quot;&lt;%- url_for(&#39;js/animations.js&#39;) %&gt;&quot;&gt;&lt;/script&gt;

&lt;!-- Project-specific Scripts (unchanged) --&gt;
&lt;% if (page.layout === &#39;project&#39;) { %&gt;
  &lt;!-- Chart.js, Two.js, propel-visualizations remain the same --&gt;
&lt;% } %&gt;
</code></pre>
<h2 id="Testing"><a href="#Testing" class="headerlink" title="Testing"></a>Testing</h2><p>After making these changes:</p>
<ol>
<li>Clear browser cache</li>
<li>Test all pages (index, blog posts, portfolio items)</li>
<li>Check browser console for errors</li>
<li>Verify all interactive features work:<ul>
<li>Sound effects</li>
<li>Modals</li>
<li>Tab switching</li>
<li>Anchor links</li>
<li>External link processing</li>
<li>Blog search</li>
<li>Carousels</li>
</ul>
</li>
</ol>
<h2 id="Rollback-Plan"><a href="#Rollback-Plan" class="headerlink" title="Rollback Plan"></a>Rollback Plan</h2><p>If issues occur, simply revert the head.ejs changes. The module system is designed to work alongside existing scripts during the transition period.</p>

!function(t){"use strict";const e=new class{constructor(){this.initialized=!1,this.currentTab="blog",this.searchIndex=null,this.initialContent={html:null,url:null}}init(){if(this.initialized)return;const e=document.querySelector(".blog-content");e&&(this.initialContent.html=e.innerHTML,this.initialContent.url=window.location.pathname+window.location.search+window.location.hash),this.initializeSearch(),this.initializeExpandButtons(),this.initializeDynamicNavigation(),this.initializeProjectToggle(),this.initializePostsOnlyButton(),this.initialized=!0,t.events.emit("blog:initialized")}initializeSearch(){const t=document.querySelector("#postSearch");t&&(t.addEventListener("input",t=>{this.handleSearch(t.target.value)}),this.buildSearchIndex())}buildSearchIndex(){this.searchIndex=[],document.querySelectorAll(".blog-post, .portfolio-item").forEach(t=>{const e=t.querySelector(".post-title, .portfolio-title")?.textContent||"",i=t.querySelector(".summary")?.textContent||"",n=Array.from(t.querySelectorAll(".tag")).map(t=>t.textContent);this.searchIndex.push({element:t,searchText:`${e} ${i} ${n.join(" ")}`.toLowerCase()})})}handleSearch(e){if(!this.searchIndex)return;const i=e.toLowerCase().trim();this.searchIndex.forEach(t=>{!i||t.searchText.includes(i)?t.element.style.display="":t.element.style.display="none"}),t.events.emit("blog:search",{query:i})}initializeExpandButtons(){document.querySelectorAll(".expand-button").forEach(t=>{t.addEventListener("click",t=>this.toggleExpand(t))})}toggleExpand(e){const i=e.currentTarget,n=i.closest(".blog-post").querySelector(".post-content");if(!n)return;const o="true"===i.getAttribute("aria-expanded");i.setAttribute("aria-expanded",!o),n.style.display=o?"none":"block",t.utils.sound&&t.utils.sound.playToggle()}initializeDynamicNavigation(){document.querySelector(".blog-content")&&window.addEventListener("popstate",t=>{t.state&&t.state.blogContent?this.restoreContent(t.state.blogContent,t.state.url):this.restoreInitialContent()})}scrollToFullStory(){const t=document.getElementById("full-story");t&&t.scrollIntoView({behavior:"smooth",block:"start"})}async fetchAndDisplayContent(e){const i=document.querySelector(".blog-content");if(!i)return;const n={blogContent:i.innerHTML,url:window.location.pathname+window.location.search+window.location.hash};window.history.replaceState(n,"",n.url);try{i.style.opacity="0.5";const t=await fetch(e),n=await t.text(),o=(new DOMParser).parseFromString(n,"text/html").querySelector(".blog-content");o&&(i.innerHTML=o.innerHTML,window.history.pushState({blogContent:o.innerHTML,url:e},"",e),this.reinitializeForDynamicContent(i),window.scrollTo({top:0,behavior:"smooth"}))}catch(t){}finally{i.style.opacity="1"}t.events.emit("blog:content-loaded",{url:e})}reinitializeForDynamicContent(e){t.ui.carousels&&t.ui.carousels.initialize&&t.ui.carousels.initialize(e),t.utils.navigation&&t.utils.navigation.initAnchorLinks&&t.utils.navigation.initAnchorLinks(),t.ui.tabs.project&&t.ui.tabs.project.init(),window.videoAutoplayManager&&window.videoAutoplayManager.refresh(),t.events.emit("blog:content-reinitialized")}initializeProjectToggle(){const t=document.querySelector(".projects-toggle-btn");t&&t.addEventListener("click",()=>{const e="blog"===(t.dataset.currentTab||"blog")?"portfolio":"blog";this.switchTab(e),t.dataset.currentTab=e})}initializePostsOnlyButton(){const t=document.querySelector(".posts-only-btn");t&&t.addEventListener("click",()=>{this.filterPostsOnly()})}switchTab(e,i=!0){t.ui.tabs.mobile&&t.ui.tabs.mobile.setActiveTab(e),i&&t.utils.sound&&t.utils.sound.playSlider(),this.currentTab=e,t.events.emit("blog:tab-switched",{tab:e})}filterPostsOnly(){document.querySelectorAll(".portfolio-item").forEach(t=>{t.style.display="none"}),t.events.emit("blog:posts-only-filtered")}restoreContent(t,e){const i=document.querySelector(".blog-content");i&&(i.innerHTML=t,this.reinitializeForDynamicContent(i))}restoreInitialContent(){this.initialContent.html&&this.restoreContent(this.initialContent.html,this.initialContent.url)}};t.content.blog=e,t.registerModule("blog",e),t.content.blog.scrollToFullStory=e.scrollToFullStory.bind(e),t.content.blog.fetchAndDisplayContent=e.fetchAndDisplayContent.bind(e),t.content.blog.initializeProjectToggle=e.initializeProjectToggle.bind(e),t.content.blog.initializePostsOnlyButton=e.initializePostsOnlyButton.bind(e)}(window.SD||(window.SD={}));
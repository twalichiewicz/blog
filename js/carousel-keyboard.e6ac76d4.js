export class CarouselKeyboard{constructor(e,t){this.element=e,this.state=t,this.enabled=!1,this.handleKeydown=this.handleKeydown.bind(this),this.handleFocus=this.handleFocus.bind(this),this.handleBlur=this.handleBlur.bind(this)}enable(){this.enabled||(this.element.setAttribute("tabindex","0"),this.element.setAttribute("role","region"),this.element.setAttribute("aria-label","Image carousel"),this.element.addEventListener("keydown",this.handleKeydown),this.element.addEventListener("focus",this.handleFocus),this.element.addEventListener("blur",this.handleBlur),this.documentKeyHandler=e=>{this.element.contains(document.activeElement)&&this.handleKeydown(e)},document.addEventListener("keydown",this.documentKeyHandler),this.enabled=!0)}disable(){this.enabled&&(this.element.removeAttribute("tabindex"),this.element.removeEventListener("keydown",this.handleKeydown),this.element.removeEventListener("focus",this.handleFocus),this.element.removeEventListener("blur",this.handleBlur),this.documentKeyHandler&&document.removeEventListener("keydown",this.documentKeyHandler),this.enabled=!1)}handleKeydown(e){if(this.isFormElement(e.target))return;let t=!0;switch(e.key){case"ArrowLeft":case"Left":this.state.prev();break;case"ArrowRight":case"Right":this.state.next();break;case"Home":this.state.setIndex(0);break;case"End":this.state.setIndex(this.state.slideCount-1);break;case" ":case"Enter":this.state.spotlightOpen&&this.state.openSpotlight();break;case"Escape":this.state.spotlightActive&&this.state.closeSpotlight();break;default:if(e.key>="1"&&e.key<="9"){const t=parseInt(e.key)-1;t<this.state.slideCount&&this.state.setIndex(t)}else t=!1}t&&(e.preventDefault(),e.stopPropagation())}handleFocus(){this.element.classList.add("keyboard-focused"),this.announceCurrentSlide()}handleBlur(){this.element.classList.remove("keyboard-focused")}announceCurrentSlide(){let e=this.element.querySelector(".carousel-live-region");e||(e=document.createElement("div"),e.className="carousel-live-region",e.setAttribute("role","status"),e.setAttribute("aria-live","polite"),e.setAttribute("aria-atomic","true"),e.style.position="absolute",e.style.left="-9999px",e.style.width="1px",e.style.height="1px",e.style.overflow="hidden",this.element.appendChild(e));const t=this.state.currentIndex+1,s=this.state.slideCount;e.textContent=`Slide ${t} of ${s}`}isFormElement(e){return["INPUT","TEXTAREA","SELECT","BUTTON"].includes(e.tagName)||"true"===e.contentEditable}}
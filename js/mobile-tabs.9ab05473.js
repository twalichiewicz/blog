import MobileTabs from"./components/MobileTabs.js";let initializationTimeout=null,isInitializing=!1;export function initializeMobileTabs(){if(initializationTimeout&&(clearTimeout(initializationTimeout),initializationTimeout=null),isInitializing)return void(initializationTimeout=setTimeout(()=>initializeMobileTabs(),300));const t=window.location.pathname;if(t.includes("/20")&&"/"!==t&&!t.includes("?")&&!document.querySelector(".blog-content"))return void(isInitializing=!1);isInitializing=!0;const e=()=>{const t=document.querySelector(".tabs-wrapper"),e=document.getElementById("postsContent"),i=document.getElementById("projectsContent"),o=document.getElementById("waresContent");console.log("[MobileTabs] DOM check:",{tabsWrapper:!!t,postsContent:!!e,projectsContent:!!i,waresContent:!!o,url:window.location.pathname}),t&&e&&i&&o?(initializeTabsInternal(),isInitializing=!1):isInitializing=!1};document.querySelector(".tabs-wrapper")?e():(setTimeout(()=>{e(),window.mobileTabs||(isInitializing=!1)},50),setTimeout(()=>{e(),isInitializing=!1},200))}function initializeTabsInternal(){if(window.mobileTabs&&"function"==typeof window.mobileTabs.destroy)try{window.mobileTabs.destroy(),window.mobileTabs=null}catch(t){window.mobileTabs=null}document.querySelector(".mobile-tabs"),document.querySelectorAll(".tab-button");try{const t=new MobileTabs({tabsWrapperSelector:".tabs-wrapper",tabContainerSelector:".mobile-tabs",tabButtonSelector:".tab-button",postsContentId:"postsContent",projectsContentId:"projectsContent",waresContentId:"waresContent",searchBarSelector:".search-bar"});window.mobileTabs=t,setTimeout(()=>{window.mobileTabs&&document.querySelectorAll(".tab-button")},100);const e=new URLSearchParams(window.location.search).get("tab");"portfolio"===e||"works"===e?t.switchTab("portfolio",!1):"wares"===e?t.switchTab("wares",!1):"blog"!==e&&"words"!==e||t.switchTab("blog",!1)}catch(t){window.mobileTabs=null}}document.addEventListener("DOMContentLoaded",()=>{initializeMobileTabs();const t=document.querySelector(".wares-grid");if(t){const e=t.querySelector(".wares-card");if(e){const i=t.style.scrollSnapType;t.style.scrollSnapType="none";const o=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=n.left-o.left+t.scrollLeft-o.width/2+n.width/2;t.scrollLeft=Math.max(0,s),requestAnimationFrame(()=>{t.style.scrollSnapType=i||"",t.classList.add("scroll-ready")})}else t.scrollLeft=0,t.classList.add("scroll-ready")}}),window.addEventListener("pageshow",function(t){if(t.persisted){initializeMobileTabs();const t=document.querySelector(".wares-grid");if(t){const e=t.querySelector(".wares-card");if(e){const i=t.style.scrollSnapType;t.style.scrollSnapType="none";const o=t.getBoundingClientRect(),n=e.getBoundingClientRect(),s=n.left-o.left+t.scrollLeft-o.width/2+n.width/2;t.scrollLeft=Math.max(0,s),requestAnimationFrame(()=>{t.style.scrollSnapType=i||"",t.classList.add("scroll-ready")})}else t.scrollLeft=0,t.classList.add("scroll-ready")}}}),void 0===window._mobiletabs_diagnostic&&(window._mobiletabs_diagnostic=!0,document.addEventListener("click",t=>{if(t.target.closest(".tab-button")){const e=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);if(console.log("[MobileTabs-Diagnostic] Tab button clicked:",{target:t.target,closest:t.target.closest(".tab-button"),type:t.target.closest(".tab-button")?.dataset.type,instanceExists:!!window.mobileTabs,defaultPrevented:t.defaultPrevented,isSafari:e,listenersAttached:window.mobileTabs?.tabClickListeners?.size||0,buttonStillInDOM:document.contains(t.target.closest(".tab-button"))}),e&&window.mobileTabs){const e=t.target.closest(".tab-button");window.mobileTabs.tabClickListeners.has(e)||(window.mobileTabs.cacheElements(),window.mobileTabs.setupEventListeners())}}},!0));
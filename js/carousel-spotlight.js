export class CarouselSpotlight{constructor(t,e,s){this.carousel=t,this.state=e,this.view=s,this.modal=null,this.isOpen=!1,this.setupImageClickHandlers(),this.state.on("spotlightOpen",({index:t})=>this.open(t)),this.state.on("spotlightClose",()=>this.close())}setupImageClickHandlers(){this.carousel.querySelectorAll(".carousel-slide img").forEach((t,e)=>{t.style.cursor="zoom-in",t.addEventListener("click",t=>{t.preventDefault(),this.state.openSpotlight(e)})})}open(t=this.state.currentIndex){this.isOpen||(this.createModal(),this.state.setSpotlightIndex(t),this.updateSpotlightContent(t),requestAnimationFrame(()=>{this.modal.classList.add("active"),document.body.classList.add("spotlight-open")}),this.isOpen=!0,this.constructor.activeSpotlight=this)}close(){this.isOpen&&this.modal&&(this.modal.classList.remove("active"),document.body.classList.remove("spotlight-open"),setTimeout(()=>{this.modal&&(this.modal.remove(),this.modal=null)},300),this.isOpen=!1,this.constructor.activeSpotlight===this&&(this.constructor.activeSpotlight=null))}createModal(){this.modal=document.createElement("div"),this.modal.className="carousel-spotlight-modal",this.modal.innerHTML='\n\t\t\t<div class="spotlight-backdrop"></div>\n\t\t\t<div class="spotlight-container">\n\t\t\t\t<button class="spotlight-close" aria-label="Close spotlight">\n\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n\t\t\t\t\t\t<path d="M18 6L6 18M6 6l12 12" stroke-width="2" stroke-linecap="round"/>\n\t\t\t\t\t</svg>\n\t\t\t\t</button>\n\t\t\t\t<div class="spotlight-content">\n\t\t\t\t\t<div class="spotlight-media-container"></div>\n\t\t\t\t</div>\n\t\t\t\t<div class="spotlight-navigation">\n\t\t\t\t\t<button class="carousel-button spotlight-prev" aria-label="Previous image">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n\t\t\t\t\t\t\t<path d="M15 18l-6-6 6-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t\t<button class="carousel-button spotlight-next" aria-label="Next image">\n\t\t\t\t\t\t<svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor">\n\t\t\t\t\t\t\t<path d="M9 18l6-6-6-6" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<div class="spotlight-indicators"></div>\n\t\t\t</div>\n\t\t',document.body.appendChild(this.modal),this.setupModalEvents(),this.createIndicators()}setupModalEvents(){this.modal.querySelector(".spotlight-close").addEventListener("click",()=>this.close()),this.modal.querySelector(".spotlight-backdrop").addEventListener("click",()=>this.close());const t=this.modal.querySelector(".spotlight-prev"),e=this.modal.querySelector(".spotlight-next");t.addEventListener("click",()=>this.navigateSpotlight("prev")),e.addEventListener("click",()=>this.navigateSpotlight("next")),this.handleKeydown=t=>{switch(t.key){case"Escape":this.close();break;case"ArrowLeft":this.navigateSpotlight("prev");break;case"ArrowRight":this.navigateSpotlight("next")}},document.addEventListener("keydown",this.handleKeydown),this.setupSpotlightGestures()}setupSpotlightGestures(){const t=this.modal.querySelector(".spotlight-content");let e=0,s=0;t.addEventListener("touchstart",t=>{e=t.touches[0].clientX,s=t.touches[0].clientY}),t.addEventListener("touchend",t=>{const i=t.changedTouches[0].clientX,o=t.changedTouches[0].clientY,n=i-e,l=o-s;Math.abs(n)>Math.abs(l)&&Math.abs(n)>50&&(n>0?this.navigateSpotlight("prev"):this.navigateSpotlight("next"))})}createIndicators(){const t=this.modal.querySelector(".spotlight-indicators");this.view.mediaElements.forEach((e,s)=>{const i=document.createElement("button");i.className="spotlight-indicator",i.setAttribute("aria-label",`Go to slide ${s+1}`),i.addEventListener("click",()=>{this.state.setSpotlightIndex(s),this.updateSpotlightContent(s)}),t.appendChild(i)}),this.updateIndicators(this.state.spotlightIndex)}updateIndicators(t){this.modal.querySelectorAll(".spotlight-indicator").forEach((e,s)=>{e.classList.toggle("active",s===t)})}navigateSpotlight(t){const e=this.state.spotlightIndex;let s;s="prev"===t?(e-1+this.state.slideCount)%this.state.slideCount:(e+1)%this.state.slideCount,this.state.setSpotlightIndex(s),this.updateSpotlightContent(s)}updateSpotlightContent(t){const e=this.modal.querySelector(".spotlight-media-container"),s=this.view.mediaElements[t];if(s){if(e.innerHTML="","image"===s.type){const t=document.createElement("img");t.src=s.src,t.alt=s.alt,t.className="spotlight-image",e.appendChild(t)}else if("video"===s.type){const t=s.element.cloneNode(!0);t.className="spotlight-video",t.controls=!0,e.appendChild(t)}else if("iframe"===s.type){const t=s.element.cloneNode(!0);t.className="spotlight-iframe",e.appendChild(t)}this.updateIndicators(t),this.updateNavigationVisibility()}}updateNavigationVisibility(){const t=this.modal.querySelector(".spotlight-prev"),e=this.modal.querySelector(".spotlight-next"),s=this.state.slideCount>1;t.style.display=s?"":"none",e.style.display=s?"":"none"}destroy(){this.modal&&this.close(),this.handleKeydown&&document.removeEventListener("keydown",this.handleKeydown)}}
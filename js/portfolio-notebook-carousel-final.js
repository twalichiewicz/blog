!function(){"use strict";function t(){return window.innerWidth<=768||"ontouchstart"in window}class e{constructor(){this.container=document.querySelector(".portfolio-featured-grid"),this.projectsContent=document.getElementById("projectsContent"),this.container&&this.projectsContent&&t()&&(this.notebooks=Array.from(this.container.querySelectorAll(".portfolio-item-wrapper")),0!==this.notebooks.length&&(this.isScrolling=!1,this.scrollTimeout=null,this.currentActiveIndex=-1,this.scrollEndDelay=150,this.initialized=!1,this.init()))}init(){this.setupContainers(),requestAnimationFrame(()=>{this.setupScrolling(),this.initialized=!0})}setupContainers(){this.projectsContent.classList.add("has-notebook-carousel"),this.container.classList.add("notebook-carousel-mobile"),document.body.classList.add("notebook-carousel-active"),this.notebooks.forEach(t=>{t.style.flexShrink="0"})}setupScrolling(){this.projectsContent.addEventListener("scroll",this.handleScroll.bind(this)),this.setupIntersectionObserver(),setTimeout(()=>{this.checkActiveNotebook()},100),window.addEventListener("resize",()=>{t()?this.initialized||this.init():this.destroy()})}setupIntersectionObserver(){this.observer&&this.observer.disconnect();const t={root:this.projectsContent,rootMargin:"-33.33% 0px -33.33% 0px",threshold:.5};this.observer=new IntersectionObserver(t=>{this.isScrolling||t.forEach(t=>{const e=this.notebooks.indexOf(t.target);t.isIntersecting&&e!==this.currentActiveIndex&&this.activateNotebook(e)})},t),this.notebooks.forEach(t=>{this.observer.observe(t)})}handleScroll(){this.isScrolling||(this.isScrolling=!0,this.deactivateAllNotebooks()),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.isScrolling=!1,this.snapToNearestNotebook()},this.scrollEndDelay)}snapToNearestNotebook(){const t=this.projectsContent.getBoundingClientRect(),e=t.top+t.height/2;let o=null,i=1/0,s=-1;this.notebooks.forEach((t,n)=>{const r=t.getBoundingClientRect(),c=r.top+r.height/2,l=Math.abs(c-e);l<i&&(i=l,o=t,s=n)}),o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{this.checkActiveNotebook()},300))}checkActiveNotebook(){const t=this.projectsContent.getBoundingClientRect(),e=t.top+t.height/2,o=t.height/3;this.notebooks.forEach((t,i)=>{const s=t.getBoundingClientRect(),n=s.top+s.height/2;Math.abs(n-e)<o/2&&i!==this.currentActiveIndex&&this.activateNotebook(i)})}activateNotebook(t){this.notebooks.forEach((e,o)=>{e.classList.remove("carousel-active","carousel-dimmed"),o!==t&&e.classList.add("carousel-dimmed")}),this.notebooks[t].classList.add("carousel-active"),this.currentActiveIndex=t,window.playBookSound&&setTimeout(()=>{window.playBookSound()},300)}deactivateAllNotebooks(){this.notebooks.forEach(t=>{t.classList.remove("carousel-active","carousel-dimmed")}),this.currentActiveIndex=-1}destroy(){this.projectsContent.classList.remove("has-notebook-carousel"),this.container.classList.remove("notebook-carousel-mobile"),document.body.classList.remove("notebook-carousel-active"),this.notebooks.forEach(t=>{t.style.flexShrink=""}),this.deactivateAllNotebooks(),this.observer&&this.observer.disconnect(),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.initialized=!1}}function o(){new e}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(o,100)}):setTimeout(o,100),document.addEventListener("contentLoaded",()=>{setTimeout(o,100)}),document.addEventListener("portfolio-loaded",()=>{setTimeout(o,100)}),window.addEventListener("load",()=>{document.querySelector(".portfolio-featured-grid.notebook-carousel-mobile")||setTimeout(o,100)})}();
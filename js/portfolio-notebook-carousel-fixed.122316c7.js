!function(){"use strict";function t(){return window.innerWidth<=768||"ontouchstart"in window}class e{constructor(){this.container=document.querySelector(".portfolio-featured-grid"),this.container&&t()&&(this.notebooks=Array.from(this.container.querySelectorAll(".portfolio-item-wrapper")),0!==this.notebooks.length&&(this.isScrolling=!1,this.scrollTimeout=null,this.currentActiveIndex=-1,this.scrollEndDelay=150,this.initialized=!1,this.init()))}init(){this.ensureContainerDimensions(),this.initWithRetry(0)}ensureContainerDimensions(){const t=this.container.parentElement;t&&"projectsContent"===t.id&&(t.style.cssText="\n                    position: relative !important;\n                    height: 100vh !important;\n                    height: 100dvh !important;\n                    overflow: hidden !important;\n                "),this.container.classList.add("notebook-carousel-mobile"),this.container.style.cssText="\n                position: absolute !important;\n                top: 0 !important;\n                left: 0 !important;\n                width: 100% !important;\n                height: 100% !important;\n                overflow-y: auto !important;\n                overflow-x: hidden !important;\n                display: flex !important;\n                flex-direction: column !important;\n                gap: 40px !important;\n                padding: 20px !important;\n                box-sizing: border-box !important;\n                -webkit-overflow-scrolling: touch !important;\n                touch-action: pan-y !important;\n                background: #f5f0eb !important;\n                z-index: 1000 !important;\n            ",window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&(this.container.style.background="#000000 !important")}initWithRetry(t){setTimeout(()=>{const e=this.container.getBoundingClientRect(),o=this.container.scrollHeight>e.height;console.log(`Attempt ${t+1}:`,{containerHeight:e.height,scrollHeight:this.container.scrollHeight,canScroll:o}),o&&e.height>0?(this.setupScrolling(),this.initialized=!0):t<4&&this.initWithRetry(t+1)},200*(t+1))}setupScrolling(){this.container.addEventListener("scroll",this.handleScroll.bind(this)),this.setupIntersectionObserver(),setTimeout(()=>{this.checkActiveNotebook()},100),window.addEventListener("resize",()=>{t()?this.setupIntersectionObserver():this.destroy()})}setupIntersectionObserver(){this.observer&&this.observer.disconnect();const t={root:this.container,rootMargin:"-33.33% 0px -33.33% 0px",threshold:.5};this.observer=new IntersectionObserver(t=>{this.isScrolling||t.forEach(t=>{const e=this.notebooks.indexOf(t.target);t.isIntersecting&&e!==this.currentActiveIndex&&this.activateNotebook(e)})},t),this.notebooks.forEach(t=>{this.observer.observe(t)})}handleScroll(){this.isScrolling||(this.isScrolling=!0,this.deactivateAllNotebooks()),this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout(()=>{this.isScrolling=!1,this.snapToNearestNotebook()},this.scrollEndDelay)}snapToNearestNotebook(){const t=this.container.getBoundingClientRect(),e=t.top+t.height/2;let o=null,i=1/0,n=-1;this.notebooks.forEach((t,s)=>{const r=t.getBoundingClientRect(),c=r.top+r.height/2,a=Math.abs(c-e);a<i&&(i=a,o=t,n=s)}),o&&(o.scrollIntoView({behavior:"smooth",block:"center"}),setTimeout(()=>{this.checkActiveNotebook()},300))}checkActiveNotebook(){const t=this.container.getBoundingClientRect(),e=t.top+t.height/2,o=t.height/3;this.notebooks.forEach((t,i)=>{const n=t.getBoundingClientRect(),s=n.top+n.height/2;Math.abs(s-e)<o/2&&i!==this.currentActiveIndex&&this.activateNotebook(i)})}activateNotebook(t){this.notebooks.forEach((e,o)=>{e.classList.remove("carousel-active","carousel-dimmed"),o!==t&&e.classList.add("carousel-dimmed")}),this.notebooks[t].classList.add("carousel-active"),this.currentActiveIndex=t,window.playBookSound&&setTimeout(()=>{window.playBookSound()},300)}deactivateAllNotebooks(){this.notebooks.forEach(t=>{t.classList.remove("carousel-active","carousel-dimmed")}),this.currentActiveIndex=-1}destroy(){this.container.classList.remove("notebook-carousel-mobile"),this.container.style.cssText="",this.deactivateAllNotebooks(),this.observer&&this.observer.disconnect(),this.scrollTimeout&&clearTimeout(this.scrollTimeout)}}function o(){new e}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>{setTimeout(o,100)}):setTimeout(o,100),document.addEventListener("contentLoaded",()=>{setTimeout(o,100)}),document.addEventListener("portfolio-loaded",()=>{setTimeout(o,100)}),window.addEventListener("load",()=>{document.querySelector(".portfolio-featured-grid.notebook-carousel-mobile")||setTimeout(o,100)})}();
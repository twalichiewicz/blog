const processedContainers=new WeakSet,defaultDevicePixelRatio="undefined"!=typeof window?window.devicePixelRatio:1;let lastDevicePixelRatio=defaultDevicePixelRatio,zoomIntervalId=null;function updateScrollState(e,t){const o=t.scrollWidth>e.clientWidth,s=e.scrollLeft,n=t.scrollWidth-e.clientWidth;e.classList.toggle("has-scroll",o),e.classList.toggle("scrolled",s>10),e.classList.toggle("at-end",s>=n-10),o&&(e.setAttribute("role","region"),e.setAttribute("aria-label","Scrollable table"),e.setAttribute("tabindex","0"))}function ensureZoomWatcher(){null===zoomIntervalId&&(zoomIntervalId=setInterval(()=>{"undefined"!=typeof window&&window.devicePixelRatio!==lastDevicePixelRatio&&(lastDevicePixelRatio=window.devicePixelRatio,document.querySelectorAll(".table-scroll-container").forEach(e=>{const t=e.querySelector("table");t&&updateScrollState(e,t)}))},500))}function bindContainer(e,t){const o=()=>updateScrollState(e,t);if(o(),!e._responsiveScrollHandler){const t=()=>o();e.addEventListener("scroll",t,{passive:!0}),e._responsiveScrollHandler=t}if(!e._responsiveResizeHandler){let t;const s=()=>{clearTimeout(t),t=setTimeout(o,100)};window.addEventListener("resize",s,{passive:!0}),e._responsiveResizeHandler=s}if("ontouchstart"in window&&!e._responsiveTouchHandlers){e.style.scrollbarWidth="thin",e.style.WebkitOverflowScrolling="touch";let t=0;const o=e=>{t=e.touches[0].clientX},s=o=>{const s=o.touches[0].clientX-t;Math.abs(s)>5&&e.classList.add("touch-scrolling")},n=()=>{e.classList.remove("touch-scrolling")};e.addEventListener("touchstart",o,{passive:!0}),e.addEventListener("touchmove",s,{passive:!0}),e.addEventListener("touchend",n,{passive:!0}),e._responsiveTouchHandlers={handleTouchStart:o,handleTouchMove:s,handleTouchEnd:n}}if(!e._responsiveKeydownHandler){const t=t=>{switch(t.key){case"ArrowLeft":e.scrollLeft-=50,t.preventDefault();break;case"ArrowRight":e.scrollLeft+=50,t.preventDefault();break;case"Home":e.scrollLeft=0,t.preventDefault();break;case"End":e.scrollLeft=e.scrollWidth,t.preventDefault()}};e.addEventListener("keydown",t),e._responsiveKeydownHandler=t}if(!e._responsiveFocusHandlers){const t=()=>e.classList.add("focused"),o=()=>e.classList.remove("focused");e.addEventListener("focus",t),e.addEventListener("blur",o),e._responsiveFocusHandlers={handleFocus:t,handleBlur:o}}processedContainers.add(e)}export function initResponsiveTables(){document.querySelectorAll(".table-scroll-container").forEach(e=>{const t=e.querySelector("table");t&&(processedContainers.has(e)?updateScrollState(e,t):bindContainer(e,t))}),ensureZoomWatcher()}export function destroyResponsiveTables(){document.querySelectorAll(".table-scroll-container").forEach(e=>{if(processedContainers.has(e)){if(e._responsiveScrollHandler&&(e.removeEventListener("scroll",e._responsiveScrollHandler),delete e._responsiveScrollHandler),e._responsiveResizeHandler&&(window.removeEventListener("resize",e._responsiveResizeHandler),delete e._responsiveResizeHandler),e._responsiveTouchHandlers){const{handleTouchStart:t,handleTouchMove:o,handleTouchEnd:s}=e._responsiveTouchHandlers;e.removeEventListener("touchstart",t),e.removeEventListener("touchmove",o),e.removeEventListener("touchend",s),delete e._responsiveTouchHandlers}if(e._responsiveKeydownHandler&&(e.removeEventListener("keydown",e._responsiveKeydownHandler),delete e._responsiveKeydownHandler),e._responsiveFocusHandlers){const{handleFocus:t,handleBlur:o}=e._responsiveFocusHandlers;e.removeEventListener("focus",t),e.removeEventListener("blur",o),delete e._responsiveFocusHandlers}processedContainers.delete(e)}}),null!==zoomIntervalId&&(clearInterval(zoomIntervalId),zoomIntervalId=null,lastDevicePixelRatio="undefined"!=typeof window?window.devicePixelRatio:1)}
export class CssWaveText{constructor(t,e={}){this.container=t,this.config={baseString:"Design in Everything ",rows:15,columns:25,reducedMotion:!1,font:{size:21,lineHeight:30,charWidth:14},...e},e.wave&&!this.config.font&&(this.config.font=e.wave.font||{size:21,lineHeight:30,charWidth:14}),this.initialized=!1,this.resizeTimeoutId=null}init(){this.initialized||(this.gridElement=document.createElement("div"),this.gridElement.className="wave-grid",this.gridElement.style.position="absolute",this.gridElement.style.top="0",this.gridElement.style.left="0",this.gridElement.style.width="100%",this.gridElement.style.height="100%",this.gridElement.style.display="grid",this.gridElement.style.zIndex="0",this.container.appendChild(this.gridElement),this.config.reducedMotion||this.createAnimationStyles(),this.buildTextGrid(),this.setupResizeObserver(),this.initialized=!0)}createAnimationStyles(){const t=document.getElementById("wave-text-animations");t&&t.parentNode.removeChild(t);const e=document.createElement("style");e.id="wave-text-animations";let i="";const n=window.innerWidth<768,s=n?1.2:3;for(let t=0;t<21;t++){const e=n?15:20;i+=`\n\t\t\t\t.wave-char-row-${t} {\n\t\t\t\t\tanimation: wave-char-anim-${t} ${s}s infinite ease-in-out;\n\t\t\t\t\tanimation-delay: ${t/21*(.7*s)}s;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\t@keyframes wave-char-anim-${t} {\n\t\t\t\t\t0%, 100% {\n\t\t\t\t\t\ttransform: translateY(0);\n\t\t\t\t\t\topacity: 0.5;\n\t\t\t\t\t}\n\t\t\t\t\t50% {\n\t\t\t\t\t\ttransform: translateY(${Math.max(8,e-t/21*12)}px);\n\t\t\t\t\t\topacity: 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t`}for(let t=0;t<15;t++)i+=`\n\t\t\t\t.wave-char-col-${t} {\n\t\t\t\t\tanimation-delay: calc(var(--base-delay) + ${t/15*.5}s);\n\t\t\t\t}\n\t\t\t`;e.textContent=i,document.head.appendChild(e)}buildTextGrid(){this.gridElement.innerHTML="";const t=this.container.clientWidth||window.innerWidth,e=this.container.clientHeight||300,{charWidth:i,lineHeight:n}=this.config.font,s=window.innerWidth<768,r=s?1.1:1,a=Math.ceil(t/(i*r))+2,o=Math.ceil(e/n);this.gridElement.style.gridTemplateRows=`repeat(${o}, ${n}px)`,this.gridElement.style.gridTemplateColumns=`repeat(${a}, ${i*r}px)`,this.gridElement.style.width="100%",this.gridElement.style.height="100%";const l=this.config.baseString||"Design in Everything ",h=l.repeat(Math.ceil(a/l.length)+1),d=window.matchMedia("(prefers-color-scheme: dark)").matches?"hsla(0, 0%, 85%,":"hsla(0, 6%, 37%,";for(let t=0;t<o;t++){const e=Math.max(.3,1-t/o*1.5),i=document.createElement("div");i.className="wave-row wave-row-"+t%21,i.style.display="contents";for(let n=0;n<a;n++){const r=h[(t*a+n)%h.length],l=document.createElement("span"),c=["wave-char"];let m;this.config.reducedMotion||(c.push("wave-char-row-"+t%21),c.push("wave-char-col-"+n%15)),l.className=c.join(" "),l.textContent=r,l.style.setProperty("--base-delay",t%21/21*3+"s"),l.style.fontSize=`${this.config.font.size}px`,l.style.lineHeight=`${this.config.font.lineHeight}px`,l.style.display="flex",l.style.justifyContent="center",l.style.alignItems="center",m=this.config.reducedMotion?.4+.6*Math.sin(t/4+n/6):(.4+.3*Math.sin(t/o*Math.PI))*e,l.style.color=`${d} ${m})`,l.style.textShadow="0 0 1px rgba(0,0,0,0.1)",s||(l.style.willChange="transform, opacity"),l.style.position="relative",l.style.fontWeight="500",i.appendChild(l)}this.gridElement.appendChild(i)}}setupResizeObserver(){"ResizeObserver"in window&&(this.resizeObserver=new ResizeObserver(t=>{this.resizeTimeoutId&&clearTimeout(this.resizeTimeoutId),this.resizeTimeoutId=setTimeout(()=>{for(const e of t)if(e.target===this.container){this.buildTextGrid();break}this.resizeTimeoutId=null},150)}),this.resizeObserver.observe(this.container)),this.resizeHandler=()=>{this.resizeTimeoutId&&clearTimeout(this.resizeTimeoutId),this.resizeTimeoutId=setTimeout(()=>{this.buildTextGrid(),this.resizeTimeoutId=null},150)},window.addEventListener("resize",this.resizeHandler),window.addEventListener("orientationchange",()=>{setTimeout(()=>this.buildTextGrid(),300)})}destroy(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeTimeoutId&&clearTimeout(this.resizeTimeoutId),window.removeEventListener("resize",this.resizeHandler),this.gridElement&&this.gridElement.parentNode&&this.gridElement.parentNode.removeChild(this.gridElement);const t=document.getElementById("wave-text-animations");t&&t.parentNode.removeChild(t),this.initialized=!1}}
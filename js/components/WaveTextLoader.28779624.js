import{CssWaveText}from"./CssWaveText.js";import{OptimizedWaveAnimation}from"./OptimizedWaveAnimation.js";const supportsFeature=e=>"css-grid"===e?window.CSS&&window.CSS.supports&&window.CSS.supports("display","grid"):"intersection-observer"===e?"IntersectionObserver"in window:"resize-observer"===e&&"ResizeObserver"in window,isLowEndDevice=()=>{const e=window.navigator;if(e.deviceMemory&&e.deviceMemory<4)return!0;if(e.hardwareConcurrency&&e.hardwareConcurrency<4)return!0;const n=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e.userAgent)||window.innerWidth<=768||window.matchMedia&&window.matchMedia("(max-width: 768px)").matches||e.maxTouchPoints&&e.maxTouchPoints>1,t=/iPad|iPhone|iPod/.test(e.userAgent)&&!window.MSStream;return n||t},prefersReducedMotion=()=>window.matchMedia("(prefers-reduced-motion: reduce)").matches,normalizeConfig=e=>{const n={baseString:"Design in Everything ",font:{size:21,lineHeight:30,charWidth:14},frequency:.009,amplitude:30,speed:3e-4};return e.baseString&&(n.baseString=e.baseString),e.font&&(n.font={...n.font,...e.font}),e.frequency&&(n.frequency=e.frequency),e.amplitude&&(n.amplitude=e.amplitude),e.speed&&(n.speed=e.speed),e.wave&&(e.wave.baseString&&(n.baseString=e.wave.baseString),e.wave.frequency&&(n.frequency=e.wave.frequency),e.wave.amplitude&&(n.amplitude=e.wave.amplitude),e.wave.speed&&(n.speed=e.wave.speed),e.wave.font&&(n.font={...n.font,...e.wave.font})),window.innerWidth<768&&(n.amplitude=.8*n.amplitude,n.speed=3*n.speed,n.frequency=1.5*n.frequency,n.font.size>18&&(n.font.size=18,n.font.lineHeight=Math.max(.9*n.font.lineHeight,24),n.font.charWidth=Math.max(.9*n.font.charWidth,12))),n};export const createWaveText=(e,n={})=>{const t=normalizeConfig(n),i=window.matchMedia("(prefers-reduced-motion: reduce)");let a=i.matches;if(i.addEventListener("change",()=>{a=i.matches;const e=document.querySelector(".wave-container");if(e){const n=document.getElementById("wave-text-animations");n&&n.parentNode.removeChild(n),e.style.opacity="0.99",setTimeout(()=>{e.style.opacity="1"},50)}}),a)return new CssWaveText(e,{...t,rows:5,columns:10,reducedMotion:!0});const r=supportsFeature("css-grid")&&supportsFeature("intersection-observer"),o=isLowEndDevice();if(window.innerWidth<768||o){let n=e.querySelector("canvas#waveCanvas");return n||(n=document.createElement("canvas"),n.id="waveCanvas",e.appendChild(n)),new OptimizedWaveAnimation(n,t)}if(r)return new CssWaveText(e,t);{let n=e.querySelector("canvas#waveCanvas");return n||(n=document.createElement("canvas"),n.id="waveCanvas",e.appendChild(n)),new OptimizedWaveAnimation(n,t)}};
!function(){"use strict";class t{constructor(t,e={}){this.wrapper=t,this.content=t.querySelector(".code-sandbox-content"),this.toggle=t.querySelector(".code-sandbox-toggle"),this.content&&this.toggle&&(this.options={autoToggleOnScroll:!0,suspendOnHide:!0,resetOnShow:!1,onShow:null,onHide:null,...e},this.isOn=!this.wrapper.classList.contains("collapsed"),this.wasAutoToggled=!1,this.suspendedScripts=[],this.animationFrames=[],this.timeouts=[],this.intervals=[],this.init())}init(){this.updateToggleState(),this.toggle.addEventListener("click",t=>this.handleToggleClick(t)),this.toggle.addEventListener("keydown",t=>this.handleToggleKeydown(t)),this.options.autoToggleOnScroll&&this.setupScrollObserver(),this.wrapper.codeSandbox=this}handleToggleClick(t){t.stopPropagation(),this.setToggleState(!this.isOn,!1),this.wasAutoToggled=!1,window.playSmallClickSound&&window.playSmallClickSound()}handleToggleKeydown(t){" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),t.stopPropagation(),this.setToggleState(!this.isOn,!1),this.wasAutoToggled=!1)}setToggleState(t,e=!1){this.isOn=t,this.isOn?this.show(e):this.hide(e),this.updateToggleState()}show(t=!1){this.wrapper.classList.remove("collapsed"),this.wasAutoToggled=!1,this.options.suspendOnHide&&this.resumeScripts(),this.options.onShow&&this.options.onShow.call(this,this.content),this.options.resetOnShow&&this.options.resetFunction&&this.options.resetFunction.call(this,this.content)}hide(t=!1){this.wrapper.classList.add("collapsed"),t&&(this.wasAutoToggled=!0),this.options.suspendOnHide&&this.suspendScripts(),this.options.onHide&&this.options.onHide.call(this,this.content)}updateToggleState(){this.toggle.classList.toggle("active",this.isOn),this.toggle.setAttribute("aria-checked",this.isOn)}suspendScripts(){(this.content.animationFrameIds||[]).forEach(t=>{cancelAnimationFrame(t),this.animationFrames.push(t)}),(this.content.timeoutIds||[]).forEach(t=>{clearTimeout(t),this.timeouts.push(t)}),(this.content.intervalIds||[]).forEach(t=>{clearInterval(t),this.intervals.push(t)}),this.content.dispatchEvent(new CustomEvent("sandbox:suspend",{bubbles:!0,detail:{sandbox:this}}))}resumeScripts(){this.content.dispatchEvent(new CustomEvent("sandbox:resume",{bubbles:!0,detail:{sandbox:this}})),this.animationFrames=[],this.timeouts=[],this.intervals=[]}setupScrollObserver(){new IntersectionObserver(t=>{t.forEach(t=>{t.isIntersecting?this.wasAutoToggled&&!this.isOn&&this.setToggleState(!0,!0):this.isOn&&this.setToggleState(!1,!0)})},{threshold:.1,rootMargin:"50px"}).observe(this.wrapper)}toggle(){this.setToggleState(!this.isOn)}suspend(){this.isOn&&this.setToggleState(!1)}resume(){this.isOn||this.setToggleState(!0)}destroy(){this.toggle.removeEventListener("click",this.handleToggleClick),this.toggle.removeEventListener("keydown",this.handleToggleKeydown),this.observer&&this.observer.disconnect(),delete this.wrapper.codeSandbox}}function e(){document.querySelectorAll('.code-sandbox-wrapper[data-auto-init="true"]').forEach(e=>{e.codeSandbox||new t(e)})}function s(){document.querySelectorAll('.code-sandbox-wrapper[data-auto-init="true"]').forEach(e=>{if(e.codeSandbox)return;const s=e.getAttribute("data-sandbox-id");s&&window.sandboxInitializers&&window.sandboxInitializers[s]?window.sandboxInitializers[s]():new t(e)})}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",e):e(),window.addEventListener("popstate",s),document.addEventListener("visibilitychange",()=>{document.hidden||setTimeout(s,100)});const i=new MutationObserver(t=>{let e=!1;t.forEach(t=>{t.addedNodes.forEach(t=>{1===t.nodeType&&(t.classList&&t.classList.contains("code-sandbox-wrapper")&&"true"===t.getAttribute("data-auto-init")||t.querySelector&&t.querySelector('.code-sandbox-wrapper[data-auto-init="true"]'))&&(e=!0)})}),e&&setTimeout(s,100)});document.body?i.observe(document.body,{childList:!0,subtree:!0}):document.addEventListener("DOMContentLoaded",()=>{i.observe(document.body,{childList:!0,subtree:!0})}),window.SD&&window.SD.events&&(window.SD.events.on("blog:content-loaded",s),window.SD.events.on("blog:content-reinitialized",s),window.SD.events.on("portfolio:content-loaded",s),window.SD.events.on("page:changed",s)),window.CodeSandbox=t,window.reinitializeCodeSandboxes=s}();
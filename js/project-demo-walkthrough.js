!function(){"use strict";class t{constructor(){this.currentStep=0,this.steps=[],this.isPlaying=!1,this.autoAdvanceTimer=null,this.autoAdvanceInterval=5e3,this.toolbar=null,this.demoIframe=null,this.isVisible=!1,this.isMinimized=!1,this.shouldAutoStart=!1,this.isInitialized=!1,this.messageHandler=null}init(){this.cleanup();const t=document.querySelector(".demo-inline-container");if(!t)return;const e=t.querySelector(".demo-inline-iframe");e?(this.demoIframe=e,this.isInitialized=!0,this.messageHandler=this.handleMessage.bind(this),window.addEventListener("message",this.messageHandler),e.contentWindow&&e.contentDocument&&"complete"===e.contentDocument.readyState?this.setupWalkthrough():e.addEventListener("load",()=>{this.setupWalkthrough()})):this.observeForIframe(t)}cleanup(){this.messageHandler&&(window.removeEventListener("message",this.messageHandler),this.messageHandler=null);const t=document.querySelector(".demo-walkthrough-toolbar");t&&t.remove(),this.toolbar&&(this.toolbar.remove(),this.toolbar=null),this.isInitialized=!1,this.isVisible=!1,this.isMinimized=!1,this.steps=[],this.currentStep=0,this.shouldAutoStart=!1,this.stopAutoAdvance()}observeForIframe(t){const e=new MutationObserver(s=>{for(const i of s)if("childList"===i.type){const s=t.querySelector(".demo-inline-iframe");if(s){e.disconnect(),this.demoIframe=s,this.isInitialized=!0,this.messageHandler=this.handleMessage.bind(this),window.addEventListener("message",this.messageHandler),s.contentWindow&&s.contentDocument&&"complete"===s.contentDocument.readyState?this.setupWalkthrough():s.addEventListener("load",()=>{this.setupWalkthrough()});break}}});e.observe(t,{childList:!0,subtree:!0})}setupWalkthrough(){setTimeout(()=>{this.demoIframe&&this.demoIframe.contentWindow&&this.demoIframe.contentWindow.postMessage({type:"checkWalkthroughSupport"},"*")},1e3)}handleMessage(t){if(t.data&&"object"==typeof t.data)switch(t.data.type){case"walkthroughSupported":this.steps=t.data.steps||[],this.steps.length>0&&this.createToolbar();break;case"walkthroughStepCompleted":this.handleNext();break;case"walkthroughEnded":this.minimizeToolbar()}}createToolbar(){const t=document.querySelector(".demo-walkthrough-toolbar");if(t)return this.toolbar=t,void this.updateUI();if(this.toolbar)return;this.toolbar=document.createElement("div"),this.toolbar.className="demo-walkthrough-toolbar",this.toolbar.innerHTML=`\n                <div class="walkthrough-toolbar-inner">\n                    <div class="walkthrough-controls-left">\n                        <button class="walkthrough-btn walkthrough-prev" aria-label="Previous step">\n                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">\n                                <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>\n                            </svg>\n                        </button>\n                        <button class="walkthrough-btn walkthrough-play-pause" aria-label="Play/Pause">\n                            <svg class="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">\n                                <path d="M8 5v14l11-7z"/>\n                            </svg>\n                            <svg class="pause-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">\n                                <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>\n                            </svg>\n                        </button>\n                        <button class="walkthrough-btn walkthrough-next" aria-label="Next step">\n                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">\n                                <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>\n                            </svg>\n                        </button>\n                    </div>\n                    \n                    <div class="walkthrough-info">\n                        <div class="walkthrough-step-title">Welcome to the Demo</div>\n                        <div class="walkthrough-step-indicator">Step 1 of ${this.steps.length}</div>\n                    </div>\n                    \n                    <div class="walkthrough-controls-right">\n                        <div class="walkthrough-cassette-deck" data-state="stopped">\n                            <div class="cassette-well">\n                                <div class="cassette-window"></div>\n                                <div class="tape-reel left-reel"></div>\n                                <div class="tape-reel right-reel"></div>\n                                <div class="deck-label"></div>\n                            </div>\n                            <div class="cassette-well">\n                                <div class="cassette-window"></div>\n                                <div class="tape-reel left-reel"></div>\n                                <div class="tape-reel right-reel"></div>\n                                <div class="deck-label"></div>\n                            </div>\n                        </div>\n                        <div class="walkthrough-progress">\n                            <div class="walkthrough-progress-bar">\n                                <div class="walkthrough-progress-fill"></div>\n                            </div>\n                        </div>\n                        <button class="walkthrough-btn walkthrough-minimize" aria-label="Minimize toolbar">\n                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">\n                                <path d="M19 13H5v-2h14v2z"/>\n                            </svg>\n                        </button>\n                        \x3c!-- Close button removed - toolbar should always be present --\x3e\n                    </div>\n                </div>\n                <div class="walkthrough-toolbar-minimized">\n                    <button class="walkthrough-btn walkthrough-maximize" aria-label="Show walkthrough">\n                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">\n                            <path d="M8 5v14l11-7z"/>\n                        </svg>\n                    </button>\n                    <span class="walkthrough-minimized-text">Demo Walkthrough</span>\n                    \x3c!-- Close button removed - toolbar should always be present --\x3e\n                </div>\n            `,document.body.appendChild(this.toolbar),this.setupEventListeners();const e=document.getElementById("demoBtn");e&&(e.hasAttribute("data-walkthrough-listener")||(e.setAttribute("data-walkthrough-listener","true"),e.addEventListener("click",()=>{setTimeout(()=>this.showToolbar(!0),600)})))}setupEventListeners(){const t=this.toolbar.querySelector(".walkthrough-prev"),e=this.toolbar.querySelector(".walkthrough-next"),s=this.toolbar.querySelector(".walkthrough-play-pause"),i=this.toolbar.querySelector(".walkthrough-minimize"),o=this.toolbar.querySelector(".walkthrough-maximize");t.addEventListener("click",()=>this.handlePrevious()),e.addEventListener("click",()=>this.handleNext()),s.addEventListener("click",()=>this.togglePlayPause()),i.addEventListener("click",()=>this.minimizeToolbar()),o.addEventListener("click",()=>this.maximizeToolbar()),document.addEventListener("keydown",t=>{if(this.isVisible)switch(t.key){case"ArrowLeft":this.handlePrevious();break;case"ArrowRight":this.handleNext();break;case" ":t.preventDefault(),this.togglePlayPause();break;case"Escape":this.isMinimized||this.minimizeToolbar()}})}showToolbar(t=!1){this.toolbar&&(this.isVisible=!0,this.isMinimized=!1,this.toolbar.classList.add("visible"),this.toolbar.classList.remove("minimized"),this.currentStep=0,this.updateUI(),t&&(this.sendStepToDemo(),this.shouldAutoStart=!0),window.soundEffects&&window.soundEffects.playSound&&window.soundEffects.playSound("notification-subtle"))}minimizeToolbar(){this.toolbar&&this.isVisible&&!this.isMinimized&&(this.isMinimized=!0,this.toolbar.classList.add("minimized"),this.stopAutoAdvance(),window.soundEffects&&window.soundEffects.playSound&&window.soundEffects.playSound("small-click"))}maximizeToolbar(){this.toolbar&&this.isVisible&&this.isMinimized&&(this.isMinimized=!1,this.toolbar.classList.remove("minimized"),this.isPlaying&&this.startAutoAdvance(),window.soundEffects&&window.soundEffects.playSound&&window.soundEffects.playSound("small-click"))}handlePrevious(){if(this.currentStep>0){const t=this.toolbar?.querySelector(".walkthrough-cassette-deck");t&&(t.setAttribute("data-state","rewinding"),setTimeout(()=>{this.isPlaying?t.setAttribute("data-state","playing"):t.setAttribute("data-state","paused")},300)),this.currentStep--,this.updateUI(),this.sendStepToDemo(),this.restartAutoAdvance()}}handleNext(){if(this.currentStep<this.steps.length-1){const t=this.toolbar?.querySelector(".walkthrough-cassette-deck");t&&(t.setAttribute("data-state","fast-forward"),setTimeout(()=>{this.isPlaying?t.setAttribute("data-state","playing"):t.setAttribute("data-state","paused")},300)),this.currentStep++,this.updateUI(),this.sendStepToDemo(),this.restartAutoAdvance()}else this.minimizeToolbar()}togglePlayPause(){this.isPlaying=!this.isPlaying;const t=this.toolbar.querySelector(".play-icon"),e=this.toolbar.querySelector(".pause-icon"),s=this.toolbar.querySelector(".walkthrough-cassette-deck");this.isPlaying?(t.style.display="none",e.style.display="block",this.startAutoAdvance(),s&&s.setAttribute("data-state","playing")):(t.style.display="block",e.style.display="none",this.stopAutoAdvance(),s&&s.setAttribute("data-state","paused")),window.soundEffects&&window.soundEffects.playSound&&window.soundEffects.playSound("small-click")}startAutoAdvance(){this.stopAutoAdvance(),this.autoAdvanceTimer=setInterval(()=>{this.handleNext()},this.autoAdvanceInterval)}stopAutoAdvance(){this.autoAdvanceTimer&&(clearInterval(this.autoAdvanceTimer),this.autoAdvanceTimer=null)}restartAutoAdvance(){this.isPlaying&&this.startAutoAdvance()}updateUI(){if(!this.toolbar)return;const t=this.steps[this.currentStep]||{},e=this.toolbar.querySelector(".walkthrough-step-title"),s=this.toolbar.querySelector(".walkthrough-step-indicator"),i=this.toolbar.querySelector(".walkthrough-progress-fill"),o=this.toolbar.querySelector(".walkthrough-cassette-deck");e.textContent=t.title||`Step ${this.currentStep+1}`,s.textContent=`Step ${this.currentStep+1} of ${this.steps.length}`;const a=(this.currentStep+1)/this.steps.length*100;i.style.width=`${a}%`,o&&o.querySelectorAll(".cassette-window").forEach(t=>{t.style.setProperty("--tape-position",`${a}%`)});const n=this.toolbar.querySelector(".walkthrough-prev"),l=this.toolbar.querySelector(".walkthrough-next");n.disabled=0===this.currentStep,l.disabled=this.currentStep===this.steps.length-1}sendStepToDemo(){if(!this.demoIframe||!this.demoIframe.contentWindow)return;const t=this.steps[this.currentStep];this.demoIframe.contentWindow.postMessage({type:"walkthroughStep",step:this.currentStep,data:t},"*")}handleFullscreenEntry(){this.steps.length>0&&this.showToolbar(!1)}handleFullscreenExit(){this.toolbar&&this.isVisible&&this.hideToolbar()}hideToolbar(){if(!this.toolbar)return;this.isVisible=!1,this.isMinimized=!1,this.toolbar.classList.remove("visible"),this.toolbar.classList.remove("minimized"),this.stopAutoAdvance(),this.currentStep=0,this.isPlaying=!1;const t=this.toolbar.querySelector(".play-icon"),e=this.toolbar.querySelector(".pause-icon");t&&(t.style.display="block"),e&&(e.style.display="none")}}let e=null;function s(){e||(e=new t,window.demoWalkthrough=e,window.triggerWalkthrough=function(){e.demoIframe?e.setupWalkthrough():e.init()}),e.init()}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",s):setTimeout(s,100),document.addEventListener("contentLoaded",function(){setTimeout(s,500)}),document.addEventListener("loadInlineDemoComponent",function(t){setTimeout(s,1e3)})}();
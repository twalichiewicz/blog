export const ScrollUtility={config:{smoothBehavior:"smooth",defaultBlock:"center",defaultInline:"nearest",glowDuration:2e3,tabSwitchDelay:1e3,headerOffset:0},init(){document.body.style.overscrollBehavior="none",this.updateHeaderOffset(),this.initAnchorLinks(),window.location.hash&&requestAnimationFrame(()=>{this.handleInitialHash()})},updateHeaderOffset(){const t=document.querySelector("nav");this.config.headerOffset=t?t.offsetHeight:0},handleInitialHash(){const t=window.location.hash;if(t){const e=document.querySelector(t);e&&this.scrollToElement(e,{behavior:"smooth",offset:this.config.headerOffset})}},initAnchorLinks(){this._boundAnchorHandler&&document.removeEventListener("click",this._boundAnchorHandler,!0),this._boundAnchorHandler=this.handleAnchorClick.bind(this),document.addEventListener("click",this._boundAnchorHandler,!0)},handleAnchorClick(t){const e=t.target.closest('a[href^="#"]');if(!e)return;const o=e.getAttribute("href");if(!o)return;if("#"===o)return void t.preventDefault();const n=o.substring(1),i=document.getElementById(n);i?(t.preventDefault(),t.stopPropagation(),this.scrollToTarget(i)):t.preventDefault()},scrollToTarget(t){const e=t.closest("#postsContent"),o=t.closest("#projectsContent");if(e||o){const o=e?"blog":"portfolio",n=document.querySelector(".tab-button.active");n&&n.getAttribute("data-type")!==o?this.switchTabAndScroll(o,t):this.scrollToElement(t,{addGlow:!0})}else this.scrollToElement(t,{addGlow:!0})},switchTabAndScroll(t,e){if(window.mobileTabs&&"function"==typeof window.mobileTabs.switchTab)window.mobileTabs.switchTab(t,!0),setTimeout(()=>{this.scrollToElement(e,{addGlow:!0})},this.config.tabSwitchDelay);else{const o=document.querySelector(`.tab-button[data-type="${t}"]`);o&&(o.click(),setTimeout(()=>{this.scrollToElement(e,{addGlow:!0})},this.config.tabSwitchDelay))}},scrollToElement(t,e={}){if(!t)return;const{behavior:o=this.config.smoothBehavior,block:n=this.config.defaultBlock,inline:i=this.config.defaultInline,offset:l=0,addGlow:c=!1,container:s=null}=e;if(c&&(t.classList.add("anchor-destination-highlight"),requestAnimationFrame(()=>{t.classList.add("active")}),setTimeout(()=>{t.classList.remove("active"),setTimeout(()=>{t.classList.remove("anchor-destination-highlight")},300)},this.config.glowDuration)),window.innerWidth<=768){const e=document.querySelector(".tabs-wrapper"),n=e?e.offsetHeight:0,i=t.getBoundingClientRect().top+window.pageYOffset,l=n+40,c=Math.max(0,i-l);window.scrollTo({top:c,behavior:o})}else{let e=s;if(!e){const o=document.querySelector(".content-wrapper");if(o){const t=window.getComputedStyle(o),n=o.scrollHeight>o.clientHeight,i="scroll"===t.overflowY||"auto"===t.overflowY;n&&i&&(e=o)}if(!e){const t=document.querySelector(".blog-content");if(t){const o=window.getComputedStyle(t),n=t.scrollHeight>t.clientHeight,i="scroll"===o.overflowY||"auto"===o.overflowY;n&&i&&(e=t)}}if(!e){let o=t.parentElement;for(;o&&o!==document.body;){const t=window.getComputedStyle(o),n=o.scrollHeight>o.clientHeight,i="scroll"===t.overflowY||"auto"===t.overflowY;if(n&&i){e=o;break}o=o.parentElement}}}if(e){const n=e.getBoundingClientRect(),i=t.getBoundingClientRect().top-n.top,l=e.scrollTop,c=document.querySelector(".tabs-wrapper"),s=l+i-((c?c.offsetHeight:0)+40);e.scrollTo({top:Math.max(0,s),behavior:o})}else{const e=t.getBoundingClientRect().top+window.pageYOffset,n=document.querySelector(".tabs-wrapper"),i=n?n.offsetHeight:0,c=Math.max(i+60,l),s=Math.max(0,e-c);window.scrollTo({top:s,behavior:o})}}},scrollToId(t,e={}){const o=document.getElementById(t);o&&this.scrollToElement(o,e)},scrollToTop(){window.scrollTo({top:0,behavior:this.config.smoothBehavior})},getScrollPosition:()=>({x:window.pageXOffset||document.documentElement.scrollLeft,y:window.pageYOffset||document.documentElement.scrollTop}),isInViewport(t,e=0){const o=t.getBoundingClientRect();return o.top>=-e&&o.left>=-e&&o.bottom<=(window.innerHeight||document.documentElement.clientHeight)+e&&o.right<=(window.innerWidth||document.documentElement.clientWidth)+e}};"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>ScrollUtility.init()):ScrollUtility.init();export default ScrollUtility;
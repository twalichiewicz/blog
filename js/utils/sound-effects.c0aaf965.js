const memoryStore=new Map;function createSafeStorage(){try{if("undefined"==typeof window||!window.localStorage)throw new Error("localStorage unavailable");const e="__sound-effects-test__";return window.localStorage.setItem(e,e),window.localStorage.removeItem(e),window.localStorage}catch(e){return{getItem:e=>memoryStore.has(e)?memoryStore.get(e):null,setItem:(e,o)=>{memoryStore.set(e,o)},removeItem:e=>{memoryStore.delete(e)}}}}const safeStorage=createSafeStorage();class SoundEffects{constructor(){this.sounds=new Map,this.enabled=!0,this.volume=.5;const e=safeStorage.getItem("sound-effects-enabled");this.enabled=null===e||"true"===e;const o=safeStorage.getItem("sound-effects-volume");this.volume=null!==o?parseFloat(o):.5}loadSound(e,o,t=["mp3","ogg","m4a"]){const n=new Audio;for(const e of t){const t=n.canPlayType(`audio/${"m4a"===e?"mp4":e}`);if("probably"===t||"maybe"===t){n.src=`${o}.${e}`;break}}return n.src||(n.src=`${o}.mp3`),n.preload="auto",n.volume=this.volume,n.addEventListener("error",e=>{}),this.sounds.set(e,n),n}play(e,o=null){if(!this.enabled)return;const t=this.sounds.get(e);if(t)try{t.currentTime=0,t.volume=null!==o?o:this.volume;const e=t.play();void 0!==e&&e.catch(e=>{})}catch(e){}}setEnabled(e){this.enabled=e,safeStorage.setItem("sound-effects-enabled",e.toString())}setVolume(e){this.volume=Math.max(0,Math.min(1,e)),safeStorage.setItem("sound-effects-volume",this.volume.toString()),this.sounds.forEach(e=>{e.volume=this.volume})}isEnabled(){return this.enabled}getVolume(){return this.volume}preloadCommonSounds(){this.loadSound("toggle","/media/toggleSound",["mp3","ogg","m4a"]),this.loadSound("buttonDown","/media/button-press-down",["mp3","m4a"]),this.loadSound("buttonUp","/media/button-press-up",["mp3","m4a"]),this.loadSound("smallClick","/media/smallClick",["mp3"]),this.loadSound("slider","/media/slider",["mp3"]),this.loadSound("wavey","/media/wavey",["mp3"]),this.loadSound("book","/media/book",["mp3","m4a"])}}const soundEffects=new SoundEffects;function initializeSoundEffects(){soundEffects.preloadCommonSounds(),window.soundEffects=soundEffects,window.initializeSoundEffects=initializeSoundEffects,window.playButtonSound=function(){soundEffects.play("smallClick")},window.playSmallClickSound=function(){soundEffects.play("smallClick")},window.playToggleSound=function(){soundEffects.play("toggle")},window.playSliderSound=function(){soundEffects.play("slider")},window.playBookSound=function(){soundEffects.play("book")}}export{soundEffects,initializeSoundEffects};export default soundEffects;
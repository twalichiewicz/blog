<!DOCTYPE html>
<html lang="en">
    <head>    
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
        <head>
  
  
  <!-- Primary Meta Tags -->
  <title>3d Skull model | Design in Everything</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Thomas Walichiewicz - Designer, Developer, Thinker">
  <meta name="author" content="Thomas Walichiewicz">
  
  <meta name="keywords" content="design, portfolio, blog, developer">
  
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html">
  
  <!-- Resource Hints for Performance -->
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://unpkg.com">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="https://static.cloudflareinsights.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  
  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="apple-touch-icon" href="/favicon.png">
  
  <!-- Theme and Color -->
  <meta name="color-scheme" content="light dark">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="rgb(245, 240, 235)" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="rgb(0, 0, 0)" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html">
  <meta property="og:title" content="3d Skull model">
  <meta property="og:description" content="Thomas Walichiewicz - Designer, Developer, Thinker">
  <meta property="og:image" content="https://twalichiewicz.github.io/favicon.png">
  <meta property="og:site_name" content="Thomas Walichiewicz">
  
  <meta property="article:author" content="Thomas Walichiewicz">
  <meta property="article:published_time" content="2025-04-30T23:17:10.000Z">
  
  <meta property="article:modified_time" content="2025-11-01T08:55:11.091Z">
  
  
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html">
  <meta name="twitter:title" content="3d Skull model">
  <meta name="twitter:description" content="Thomas Walichiewicz - Designer, Developer, Thinker">
  <meta name="twitter:image" content="https://twalichiewicz.github.io/favicon.png">
  
  
  <!-- Cache Control - Prevent aggressive caching -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <!-- Security Headers (Meta Tag Equivalents) -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com https://static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data: https:; font-src 'self' https://cdn.jsdelivr.net; connect-src 'self' https:; media-src 'self'; object-src 'none'; frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com https://player.vimeo.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self';">
  <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), interest-cohort=()">
  
  <!-- Robots Meta -->
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  
  <!-- Stylesheets -->
  <link rel="preload" href="/styles/styles.css?v=1761987390406" as="style">
  <link rel="stylesheet" href="/styles/styles.css?v=1761987390406">
  
  <!-- Initial loading state -->
  <style>
    body:not(.loaded) {
      overflow: hidden;
    }
  </style>
  
  <!-- Project-specific Scripts -->
  
  
  <!-- Theme now relies on prefers-color-scheme media queries -->

  <!-- Import Map -->
  <script type="importmap">
  {
    "imports": {
      "canvas-confetti": "https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/+esm",
      "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
      "three/examples/": "https://unpkg.com/three@0.160.0/examples/"
    }
  }
  </script>

  <!-- Core Scripts -->
  <script src="/js/san-diego-namespace.js?v=1761987390406"></script>
  <script type="module" src="/js/main.js?v=1761987390406"></script>
  <script type="module" src="/js/components/HomeVisuals.js?v=1761987390406"></script>
  <script type="module" src="/js/mobile-tabs.js?v=1761987390406"></script>
  <script type="module" src="/js/carousel.js?v=1761987390406"></script>
  <script type="module" src="/js/utils/animations.js?v=1761987390406"></script>
  <script src="/js/project-tabs.js?v=1761987390406"></script>
  <script src="/js/project-summary.js?v=1761987390406"></script>
  <script type="module" src="/js/scroll.js?v=1761987390406"></script>
  <script src="/js/sound-effects.js?v=1761987390406"></script>
  <script src="/js/screen-wipe-transition.js?v=1761987390406"></script>
  <script src="/js/external-links.js?v=1761987390406"></script>
  <script src="/js/project-demo.js?v=1761987390406"></script>
  <script src="/js/project-demo-walkthrough.js?v=1761987390406"></script>
  <script src="/js/byline-modal.js?v=1761987390406"></script>
  <script src="/js/portfolio-parallax-optimized.js?v=1761987390406"></script>
  <script src="/js/portfolio-filters.js?v=1761987390406"></script>
  <script src="/js/portfolio-filters-dropdown.js?v=1761987390406"></script>
  <script src="/js/portfolio-notebook-carousel-state.js?v=1761987390406"></script>
  <script src="/js/notebook-skeleton-loader.js?v=1761987390406"></script>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "WebSite",
        "@id": "https://twalichiewicz.github.io/#website",
        "url": "https://twalichiewicz.github.io",
        "name": "Thomas Walichiewicz",
        "description": "Thomas Walichiewicz - Designer, Developer, Thinker",
        "publisher": {
          "@id": "https://twalichiewicz.github.io/#person"
        }
      },
      {
        "@type": "Person",
        "@id": "https://twalichiewicz.github.io/#person",
        "name": "Thomas Walichiewicz",
        "url": "https://twalichiewicz.github.io",
        "sameAs": [
          
          
          
        ],
        "jobTitle": "Designer & Developer",
        "description": "Designer, researcher, and relentless problem solver"
      },
      {
        "@type": "Article",
        "@id": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html#article",
        "isPartOf": {
          "@id": "https://twalichiewicz.github.io/#website"
        },
        "author": {
          "@id": "https://twalichiewicz.github.io/#person"
        },
        "headline": "3d Skull model",
        "description": "Thomas Walichiewicz - Designer, Developer, Thinker",
        "image": "https://twalichiewicz.github.io/favicon.png",
        "datePublished": "2025-04-30T23:17:10.000Z",
        
        "dateModified": "2025-11-01T08:55:11.091Z",
        
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html"
        },
        "publisher": {
          "@id": "https://twalichiewicz.github.io/#person"
        }
      },
      {
        "@type": "BreadcrumbList",
        "@id": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html#breadcrumb",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://twalichiewicz.github.io"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Blog",
            "item": "https://twalichiewicz.github.io/?tab=blog"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "3d Skull model",
            "item": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html"
          }
        ]
      }
    ]
  }
  </script>
  
  <!-- RSS Feed -->
  
  <link rel="alternate" type="application/rss+xml" title="Thomas Walichiewicz" href="/rss2.xml">
  
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 8.0.0"></head>
    </head>
    <body>
        <!-- Skip Navigation Links for Accessibility -->
<a href="#main-content" class="skip-nav-link">Skip to main content</a>

<a href="#post-content" class="skip-nav-link">Skip to article content</a>


<style>
.skip-nav-link {
  position: absolute;
  top: -40px;
  left: 0;
  background: var(--text-color, #000);
  color: var(--background-color, #fff);
  padding: 8px 16px;
  text-decoration: none;
  border-radius: 0 0 4px 0;
  z-index: 100;
  font-weight: 500;
  font-size: 14px;
  transition: top 0.2s ease;
}

.skip-nav-link:focus {
  top: 0;
  outline: 2px solid var(--accent-color, #f0b90b);
  outline-offset: 2px;
}

/* Ensure links are visible when using keyboard navigation */
.skip-nav-link:focus-visible {
  top: 0;
}

/* Dark mode support */
[data-theme="dark"] .skip-nav-link {
  background: #fff;
  color: #000;
}

@media (prefers-reduced-motion: no-preference) {
  .skip-nav-link {
    transition: top 0.2s cubic-bezier(0.4, 0, 0.2, 1);
  }
}
</style>
		<!DOCTYPE html>
<html>
    <head>
  
  
  <!-- Primary Meta Tags -->
  <title>3d Skull model | Design in Everything</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Thomas Walichiewicz - Designer, Developer, Thinker">
  <meta name="author" content="Thomas Walichiewicz">
  
  <meta name="keywords" content="design, portfolio, blog, developer">
  
  
  <!-- Canonical URL -->
  <link rel="canonical" href="https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html">
  
  <!-- Resource Hints for Performance -->
  <link rel="dns-prefetch" href="https://cdn.jsdelivr.net">
  <link rel="dns-prefetch" href="https://unpkg.com">
  <link rel="dns-prefetch" href="https://cdnjs.cloudflare.com">
  <link rel="dns-prefetch" href="https://static.cloudflareinsights.com">
  <link rel="preconnect" href="https://cdn.jsdelivr.net" crossorigin>
  <link rel="preconnect" href="https://unpkg.com" crossorigin>
  
  <!-- Favicon and App Icons -->
  <link rel="icon" type="image/png" href="/favicon.png">
  <link rel="apple-touch-icon" href="/favicon.png">
  
  <!-- Theme and Color -->
  <meta name="color-scheme" content="light dark">
  <meta name="theme-color" media="(prefers-color-scheme: light)" content="rgb(245, 240, 235)" />
  <meta name="theme-color" media="(prefers-color-scheme: dark)" content="rgb(0, 0, 0)" />
  
  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html">
  <meta property="og:title" content="3d Skull model">
  <meta property="og:description" content="Thomas Walichiewicz - Designer, Developer, Thinker">
  <meta property="og:image" content="https://twalichiewicz.github.io/favicon.png">
  <meta property="og:site_name" content="Thomas Walichiewicz">
  
  <meta property="article:author" content="Thomas Walichiewicz">
  <meta property="article:published_time" content="2025-04-30T23:17:10.000Z">
  
  <meta property="article:modified_time" content="2025-11-01T08:55:11.091Z">
  
  
  
  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:url" content="https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html">
  <meta name="twitter:title" content="3d Skull model">
  <meta name="twitter:description" content="Thomas Walichiewicz - Designer, Developer, Thinker">
  <meta name="twitter:image" content="https://twalichiewicz.github.io/favicon.png">
  
  
  <!-- Cache Control - Prevent aggressive caching -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
  <meta http-equiv="Pragma" content="no-cache">
  <meta http-equiv="Expires" content="0">
  
  <!-- Security Headers (Meta Tag Equivalents) -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  <meta http-equiv="X-Frame-Options" content="SAMEORIGIN">
  <meta name="referrer" content="strict-origin-when-cross-origin">
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.jsdelivr.net https://unpkg.com https://cdnjs.cloudflare.com https://static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data: https:; font-src 'self' https://cdn.jsdelivr.net; connect-src 'self' https:; media-src 'self'; object-src 'none'; frame-src 'self' https://www.youtube.com https://www.youtube-nocookie.com https://player.vimeo.com; frame-ancestors 'none'; base-uri 'self'; form-action 'self';">
  <meta http-equiv="Permissions-Policy" content="camera=(), microphone=(), geolocation=(), interest-cohort=()">
  
  <!-- Robots Meta -->
  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow">
  
  <!-- Stylesheets -->
  <link rel="preload" href="/styles/styles.css?v=1761987389169" as="style">
  <link rel="stylesheet" href="/styles/styles.css?v=1761987389169">
  
  <!-- Initial loading state -->
  <style>
    body:not(.loaded) {
      overflow: hidden;
    }
  </style>
  
  <!-- Project-specific Scripts -->
  
  
  <!-- Theme now relies on prefers-color-scheme media queries -->

  <!-- Import Map -->
  <script type="importmap">
  {
    "imports": {
      "canvas-confetti": "https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/+esm",
      "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
      "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
      "three/examples/": "https://unpkg.com/three@0.160.0/examples/"
    }
  }
  </script>

  <!-- Core Scripts -->
  <script src="/js/san-diego-namespace.js?v=1761987389169"></script>
  <script type="module" src="/js/main.js?v=1761987389169"></script>
  <script type="module" src="/js/components/HomeVisuals.js?v=1761987389169"></script>
  <script type="module" src="/js/mobile-tabs.js?v=1761987389169"></script>
  <script type="module" src="/js/carousel.js?v=1761987389169"></script>
  <script type="module" src="/js/utils/animations.js?v=1761987389169"></script>
  <script src="/js/project-tabs.js?v=1761987389169"></script>
  <script src="/js/project-summary.js?v=1761987389169"></script>
  <script type="module" src="/js/scroll.js?v=1761987389169"></script>
  <script src="/js/sound-effects.js?v=1761987389169"></script>
  <script src="/js/screen-wipe-transition.js?v=1761987389169"></script>
  <script src="/js/external-links.js?v=1761987389169"></script>
  <script src="/js/project-demo.js?v=1761987389169"></script>
  <script src="/js/project-demo-walkthrough.js?v=1761987389169"></script>
  <script src="/js/byline-modal.js?v=1761987389169"></script>
  <script src="/js/portfolio-parallax-optimized.js?v=1761987389169"></script>
  <script src="/js/portfolio-filters.js?v=1761987389169"></script>
  <script src="/js/portfolio-filters-dropdown.js?v=1761987389169"></script>
  <script src="/js/portfolio-notebook-carousel-state.js?v=1761987389169"></script>
  <script src="/js/notebook-skeleton-loader.js?v=1761987389169"></script>
  
  <!-- Structured Data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@graph": [
      {
        "@type": "WebSite",
        "@id": "https://twalichiewicz.github.io/#website",
        "url": "https://twalichiewicz.github.io",
        "name": "Thomas Walichiewicz",
        "description": "Thomas Walichiewicz - Designer, Developer, Thinker",
        "publisher": {
          "@id": "https://twalichiewicz.github.io/#person"
        }
      },
      {
        "@type": "Person",
        "@id": "https://twalichiewicz.github.io/#person",
        "name": "Thomas Walichiewicz",
        "url": "https://twalichiewicz.github.io",
        "sameAs": [
          
          
          
        ],
        "jobTitle": "Designer & Developer",
        "description": "Designer, researcher, and relentless problem solver"
      },
      {
        "@type": "Article",
        "@id": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html#article",
        "isPartOf": {
          "@id": "https://twalichiewicz.github.io/#website"
        },
        "author": {
          "@id": "https://twalichiewicz.github.io/#person"
        },
        "headline": "3d Skull model",
        "description": "Thomas Walichiewicz - Designer, Developer, Thinker",
        "image": "https://twalichiewicz.github.io/favicon.png",
        "datePublished": "2025-04-30T23:17:10.000Z",
        
        "dateModified": "2025-11-01T08:55:11.091Z",
        
        "mainEntityOfPage": {
          "@type": "WebPage",
          "@id": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html"
        },
        "publisher": {
          "@id": "https://twalichiewicz.github.io/#person"
        }
      },
      {
        "@type": "BreadcrumbList",
        "@id": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html#breadcrumb",
        "itemListElement": [
          {
            "@type": "ListItem",
            "position": 1,
            "name": "Home",
            "item": "https://twalichiewicz.github.io"
          },
          {
            "@type": "ListItem",
            "position": 2,
            "name": "Blog",
            "item": "https://twalichiewicz.github.io/?tab=blog"
          },
          {
            "@type": "ListItem",
            "position": 3,
            "name": "3d Skull model",
            "item": "https://twalichiewicz.github.io/2025/04/30/3d-Skull-model/index.html"
          }
        ]
      }
    ]
  }
  </script>
  
  <!-- RSS Feed -->
  
  <link rel="alternate" type="application/rss+xml" title="Thomas Walichiewicz" href="/rss2.xml">
  
  
</head>
    <body>
        <script>
            // Redirect to homepage with post path
            (function() {
                const currentPath = window.location.pathname;
                const isDirectAccess = !document.referrer || !document.referrer.includes(window.location.origin);
                const isRefresh = window.performance && window.performance.navigation && window.performance.navigation.type === 1;
                
                // Redirect if accessing directly OR on refresh (not from within the site)
                if ((isDirectAccess || isRefresh) && currentPath !== '/') {
                    // Redirect to homepage with post parameter
                    window.location.href = '/?post=' + encodeURIComponent(currentPath);
                }
            })();
        </script>
        
        <div class="page-transition-overlay"></div>
        
        <div class="post-wrapper dynamic-loaded" id="main-content">
            <!-- Dynamic content will extract this wrapper -->
            <div class="post-content-wrapper">
                
                <article class="substack-post" id="post-content">
            <!-- Post header content -->
            <header class="post-header">
                <div class="post-header-container">
                    <!-- Title -->
                    <h1 class="post-title">3d Skull model</h1>
                    
                    <!-- Subtitle/excerpt if available -->
                    
                    
                    <!-- Author info and metadata -->
                    <div class="post-byline">
                        <div class="author-info">
                            <div class="author-details">
                                <div class="post-metadata">
                                    
                                    <time class="post-date" datetime="2025-04-30">
                                        Apr 30, 2025
                                    </time>
                                    
                                    
                                    
                                    
                                    <span class="reading-time-separator">·</span>
                                    <span class="post-reading-time">
                                        6 min read
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </header>
            
            <!-- Cover image section -->
            
            
            
            
            <!-- Post content -->
            <div class="post-content-container">
                <div class="post-content">
                    
<div class="code-sandbox-wrapper" 
     data-auto-init="true"
     data-sandbox-id="sandbox-xlek9wokh"
     data-auto-toggle="true"
     data-suspend="true"
     data-reset="false">
  <div class="code-sandbox-content">
<style>
#skull-container {
  width: 100%;
  height: 400px;
  position: relative;
  margin: 0;
  border: 1px solid #ccc;
  background: rgba(0,0,0,0.02);
  border-radius: 8px;
  overflow: hidden;
}

.skull-container {
  width: 100%;
  height: 100%;
}

#skullCanvas {
  width: 100% !important;
  height: 100% !important;
  outline: none;
}

#error-message {
  color: red;
  padding: 1rem;
  margin: 1rem;
  background: rgba(255,0,0,0.1);
  border-radius: 4px;
  display: none;
}

#loading-message {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  color: #666;
  font-size: 14px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.loading-spinner {
  width: 16px;
  height: 16px;
  border: 2px solid #ccc;
  border-top-color: #666;
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}
</style>

<div id="error-message"></div>
<div id="skull-container">
  <div id="loading-message">
    <div class="loading-spinner"></div>
    Loading 3D model...
  </div>
</div>

<script type="module">
import * as THREE from 'https://unpkg.com/three@0.160.0/build/three.module.js';
import { OBJLoader } from 'https://unpkg.com/three@0.160.0/examples/jsm/loaders/OBJLoader.js';
import { MTLLoader } from 'https://unpkg.com/three@0.160.0/examples/jsm/loaders/MTLLoader.js';

// Error handling
const showError = (message) => {
  console.error(message);
  const errorDiv = document.getElementById('error-message');
  if (errorDiv) {
    errorDiv.textContent = message;
    errorDiv.style.display = 'block';
  }
  // Hide loading message
  const loadingDiv = document.getElementById('loading-message');
  if (loadingDiv) loadingDiv.style.display = 'none';
};

class PatchedSkullAnimation {
  constructor(canvas, modelPath, mtlPath, config = {}) {
    this.canvas = canvas;
    this.modelPath = modelPath;
    this.mtlPath = mtlPath;
    this.config = {
      mouseLookFactor: 0.05,
      dragRotationSpeed: 0.005,
      resetDelay: 2000,
      resetSpeed: 0.05,
      autoRotationSpeed: 0.0005,
      ...config
    };

    // Add timestamp tracking for rotation
    this.lastTimestamp = 0;
    this.accumulatedRotation = 0;

    // Get container dimensions
    this.container = this.canvas.parentElement;
    this.containerRect = this.container.getBoundingClientRect();

    // Initialize Three.js components
    this.scene = new THREE.Scene();
    this.scene.background = new THREE.Color(0xffffff);

    // Set up camera with proper aspect ratio
    this.camera = new THREE.PerspectiveCamera(
      35, // Even narrower FOV for closer view
      this.containerRect.width / this.containerRect.height,
      0.1,
      1000
    );
    this.camera.position.set(0, 0, 4);
    this.camera.lookAt(0, 0, 0);

    // Set up renderer with proper size and DPI handling
    this.renderer = new THREE.WebGLRenderer({
      canvas: this.canvas,
      antialias: true,
      alpha: true,
      powerPreference: "high-performance"
    });
    this.renderer.setPixelRatio(window.devicePixelRatio);
    this.renderer.setSize(this.containerRect.width, this.containerRect.height, false);
    this.renderer.outputColorSpace = THREE.SRGBColorSpace;
    this.renderer.toneMapping = THREE.ACESFilmicToneMapping;
    this.renderer.toneMappingExposure = 1.0;

    // Studio lighting setup
    // Main key light (top-right)
    const keyLight = new THREE.DirectionalLight(0xffffff, 1.2);
    keyLight.position.set(2, 3, 4);
    this.scene.add(keyLight);

    // Fill light (left side)
    const fillLight = new THREE.DirectionalLight(0xf2e6d9, 0.7); // Warm fill
    fillLight.position.set(-4, 0, 3);
    this.scene.add(fillLight);

    // Rim light (back-right)
    const rimLight = new THREE.DirectionalLight(0xd9ebf2, 0.8); // Cool rim
    rimLight.position.set(3, 2, -3);
    this.scene.add(rimLight);

    // Top light for subtle highlights
    const topLight = new THREE.DirectionalLight(0xffffff, 0.4);
    topLight.position.set(0, 5, 0);
    this.scene.add(topLight);

    // Soft ambient light
    const ambientLight = new THREE.HemisphereLight(
      0xffffff, // Sky color
      0xe6d9cc, // Ground color
      0.4 // Intensity
    );
    this.scene.add(ambientLight);

    console.log('Loading model from:', this.modelPath);

    // Load material first
    const mtlLoader = new MTLLoader();
    mtlLoader.load(this.mtlPath,
      (materials) => {
        materials.preload();
        console.log('Materials loaded:', materials);

        // Then load the model with materials
        const objLoader = new OBJLoader();
        objLoader.setMaterials(materials);
        objLoader.load(
          this.modelPath,
          (obj) => {
            console.log('Model loaded successfully:', obj);
            this.skull = obj;

            // Apply material to all meshes
            obj.traverse((child) => {
              if (child instanceof THREE.Mesh) {
                child.material = new THREE.MeshStandardMaterial({
                  color: 0xf5f5f0, // Very subtle off-white
                  metalness: 0.0,
                  roughness: 0.85, // Slightly reduced for better light interaction
                  emissive: 0x000000,
                  emissiveIntensity: 0
                });

                // Add subtle shadows
                child.castShadow = true;
                child.receiveShadow = true;
              }
            });

            this.scene.add(this.skull);
            this.centerModel();
            this.animate();

            // Hide loading message
            const loadingDiv = document.getElementById('loading-message');
            if (loadingDiv) loadingDiv.style.display = 'none';
          },
          (progress) => {
            const percent = (progress.loaded / progress.total * 100).toFixed(0);
            const loadingDiv = document.getElementById('loading-message');
            if (loadingDiv) {
              loadingDiv.textContent = `Loading 3D model... ${percent}%`;
            }
          },
          (error) => {
            console.error('Error loading model:', error);
            showError(`Failed to load 3D model: ${error.message}`);
          }
        );
      },
      undefined,
      (error) => {
        console.error('Error loading materials:', error);
        showError(`Failed to load materials: ${error.message}`);
      }
    );

    // Event listeners
    this.onPointerMove = this.onPointerMove.bind(this);
    this.onPointerDown = this.onPointerDown.bind(this);
    this.onPointerUp = this.onPointerUp.bind(this);
    this.onWindowResize = this.onWindowResize.bind(this);

    this.canvas.addEventListener('pointermove', this.onPointerMove);
    this.canvas.addEventListener('pointerdown', this.onPointerDown);
    this.canvas.addEventListener('pointerup', this.onPointerUp);
    window.addEventListener('resize', this.onWindowResize);

    // Initial resize
    this.onWindowResize();
  }

  centerModel() {
    if (!this.skull) return;

    const box = new THREE.Box3().setFromObject(this.skull);
    const center = box.getCenter(new THREE.Vector3());
    const size = box.getSize(new THREE.Vector3());

    // Center the model
    this.skull.position.x = -center.x;
    this.skull.position.y = -center.y;
    this.skull.position.z = -center.z;

    // Adjust camera to fit model
    const maxDim = Math.max(size.x, size.y, size.z);
    const fov = this.camera.fov * (Math.PI / 180);
    let cameraZ = Math.abs(maxDim / Math.tan(fov / 2));

    // Reduced padding for closer view
    cameraZ *= 1.2; // Changed from 1.5 to 1.2 for closer view

    this.camera.position.z = cameraZ;
    this.camera.lookAt(0, 0, 0);

    // Update camera near/far
    this.camera.near = cameraZ / 100;
    this.camera.far = cameraZ * 100;
    this.camera.updateProjectionMatrix();

    // Initial rotation for better view
    this.skull.rotation.y = Math.PI / 8;
    this.skull.rotation.x = -Math.PI / 16;
  }

  onPointerMove(event) {
    // Convert page coordinates to container-relative coordinates
    const rect = this.container.getBoundingClientRect();
    const x = event.clientX - rect.left;
    const y = event.clientY - rect.top;

    if (this.isDragging) {
      this.updateInteractionTime();
    }

    this.pointerX = (x / rect.width) * 2 - 1;
    this.pointerY = -((y / rect.height) * 2 - 1);

    if (this.isDragging && this.previousMouseX !== undefined) {
      const deltaX = event.clientX - this.previousMouseX;
      const deltaY = event.clientY - this.previousMouseY;

      this.rotationY = (this.rotationY || 0) + deltaX * this.config.dragRotationSpeed;
      this.rotationX = (this.rotationX || 0) + deltaY * this.config.dragRotationSpeed;
      this.rotationX = Math.max(-Math.PI / 3, Math.min(Math.PI / 3, this.rotationX));
    }

    this.previousMouseX = event.clientX;
    this.previousMouseY = event.clientY;
  }

  onPointerDown(event) {
    this.isDragging = true;
    this.canvas.classList.add('dragging');
    this.previousMouseX = event.clientX;
    this.previousMouseY = event.clientY;
    this.updateInteractionTime();

    // Store the current rotation state
    if (this.skull) {
      this.rotationY = this.skull.rotation.y;
      this.rotationX = this.skull.rotation.x;
    }
  }

  onPointerUp() {
    this.isDragging = false;
    this.canvas.classList.remove('dragging');

    // Store the final rotation position to continue from here
    if (this.skull) {
      this.accumulatedRotation = this.skull.rotation.y % (2 * Math.PI);
      this.lastTimestamp = performance.now();
    }
  }

  onWindowResize() {
    const rect = this.container.getBoundingClientRect();
    this.camera.aspect = rect.width / rect.height;
    this.camera.updateProjectionMatrix();
    this.renderer.setSize(rect.width, rect.height, false);
  }

  updateInteractionTime() {
    this.lastInteractionTime = performance.now();
  }

  animate(timestamp = 0) {
    if (this.skull) {
      if (this.isDragging) {
        // During drag, use the stored rotation plus mouse movement
        this.skull.rotation.y = this.rotationY + this.pointerX * this.config.mouseLookFactor;
        this.skull.rotation.x = this.rotationX + this.pointerY * this.config.mouseLookFactor;
      } else {
        // When not dragging, continue rotation from last position
        const deltaTime = this.lastTimestamp ? timestamp - this.lastTimestamp : 0;
        this.accumulatedRotation += deltaTime * this.config.autoRotationSpeed;
        this.skull.rotation.y = this.accumulatedRotation;
        this.skull.rotation.x = this.rotationX || 0;
      }
      this.lastTimestamp = timestamp;
    }

    this.renderer.render(this.scene, this.camera);
    this.animationFrameId = requestAnimationFrame((t) => this.animate(t));
  }

  destroy() {
    if (this.animationFrameId) {
      cancelAnimationFrame(this.animationFrameId);
    }

    this.canvas.removeEventListener('pointermove', this.onPointerMove);
    this.canvas.removeEventListener('pointerdown', this.onPointerDown);
    this.canvas.removeEventListener('pointerup', this.onPointerUp);
    window.removeEventListener('resize', this.onWindowResize);

    if (this.skull) {
      this.scene.remove(this.skull);
      this.skull.traverse((child) => {
        if (child.geometry) child.geometry.dispose();
        if (child.material) {
          if (Array.isArray(child.material)) {
            child.material.forEach(material => material.dispose());
          } else {
            child.material.dispose();
          }
        }
      });
    }

    this.renderer.dispose();
  }
}

// Initialize everything
const init = async () => {
  try {
    const modelPath = '/img/skully3d.obj';
    const mtlPath = '/img/skully3d.mtl';

    // Test file accessibility
    const [modelResponse, mtlResponse] = await Promise.all([
      fetch(modelPath),
      fetch(mtlPath)
    ]);

    if (!modelResponse.ok) throw new Error(`Model not found (${modelResponse.status})`);
    if (!mtlResponse.ok) throw new Error(`Material not found (${mtlResponse.status})`);

    console.log('✓ Files accessible:', { modelPath, mtlPath });

    const container = document.getElementById('skull-container');
    if (!container) throw new Error('Container not found');

    const canvas = document.createElement('canvas');
    canvas.id = 'skullCanvas';
    container.appendChild(canvas);

    window.skullAnimation = new PatchedSkullAnimation(canvas, modelPath, mtlPath, {
    mouseLookFactor: 0.05,
    autoRotationSpeed: 0.0005
    });

    console.log('✓ Initialization complete');
  } catch (error) {
    showError(`Setup failed: ${error.message}`);
    throw error;
  }
};

// Start initialization
init().catch(error => console.error('Fatal error:', error));

// Handle code-sandbox events
const canvas = document.getElementById('skullCanvas');
if (canvas) {
  const container = canvas.closest('.code-sandbox-content');
  if (container) {
    let animation = null;
    
    container.addEventListener('sandbox:suspend', () => {
      // Find and destroy the animation instance
      if (window.skullAnimation) {
        window.skullAnimation.destroy();
        window.skullAnimation = null;
      }
    });
    
    container.addEventListener('sandbox:resume', () => {
      // Reinitialize the animation
      init().catch(error => console.error('Resume error:', error));
    });
  }
}
</script>
  </div>
  
  <div class="code-sandbox-chin">
    <div class="code-sandbox-brand">
      <!-- Light mode logo -->
      <svg class="code-sandbox-logo code-sandbox-logo-light" width="242" height="249" viewBox="0 0 242 249" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M124.64 0C167.003 0 188.185 0.000318576 204.189 8.63574C216.552 15.3064 226.694 25.4477 233.364 37.8105C242 53.8148 242 74.9968 242 117.36V131.64C242 174.003 242 195.185 233.364 211.189C226.694 223.552 216.552 233.694 204.189 240.364C188.185 249 167.003 249 124.64 249H117.36C74.9968 249 53.8148 249 37.8105 240.364C25.4477 233.694 15.3064 223.552 8.63574 211.189C0.000317729 195.185 0 174.003 0 131.64V117.36C0 74.9968 0.000318576 53.8148 8.63574 37.8105C15.3064 25.4477 25.4477 15.3064 37.8105 8.63574C53.8148 0.000318576 74.9968 0 117.36 0H124.64ZM30 136C25.0294 136 21 140.029 21 145V183.357C21.0001 208.013 40.9872 228 65.6426 228C68.6012 228 71 225.601 71 222.643V166C71 149.431 57.5685 136 41 136H30ZM128.791 199.651C124.303 195.82 117.697 195.82 113.209 199.651L98.5615 212.155C92.1999 217.586 96.04 228 104.404 228H137.596C145.96 228 149.8 217.586 143.438 212.155L128.791 199.651ZM201 136C184.431 136 171 149.431 171 166V222.643C171 225.601 173.399 228 176.357 228C201.013 228 221 208.013 221 183.357V145C221 140.029 216.971 136 212 136H201ZM67.4287 21C41.7869 21 21 41.7869 21 67.4287C21.0001 70.5056 23.4944 72.9999 26.5713 73H52C76.8528 73 97 93.1472 97 118V177.506C97 179.533 99.4511 180.549 100.885 179.115C111.994 168.006 130.006 168.006 141.115 179.115C142.549 180.549 145 179.533 145 177.506V118C145 93.1472 165.147 73 190 73H215.429C218.506 72.9999 221 70.5056 221 67.4287C221 41.7869 200.213 21 174.571 21H67.4287Z" fill="currentColor"/>
      </svg>
      <!-- Dark mode logo -->
      <svg class="code-sandbox-logo code-sandbox-logo-dark" width="200" height="207" viewBox="0 0 200 207" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 115C36.5685 115 50 128.431 50 145V201.643C50 204.601 47.6012 207 44.6426 207C19.9872 207 0.000146651 187.013 0 162.357V124C2.96367e-06 119.029 4.02944 115 9 115H20ZM92.209 178.651C96.6967 174.82 103.303 174.82 107.791 178.651L122.438 191.155C128.8 196.586 124.96 207 116.596 207H83.4043C75.04 207 71.1999 196.586 77.5615 191.155L92.209 178.651ZM191 115C195.971 115 200 119.029 200 124V162.357C200 187.013 180.013 207 155.357 207C152.399 207 150 204.601 150 201.643V145C150 128.431 163.431 115 180 115H191ZM153.571 0C179.213 1.12084e-06 200 20.7869 200 46.4287C200 49.5056 197.506 51.9999 194.429 52H169C144.147 52 124 72.1472 124 97V156.506C124 158.533 121.549 159.549 120.115 158.115C109.006 147.006 90.994 147.006 79.8848 158.115C78.4511 159.549 76 158.533 76 156.506V97C76 72.1472 55.8528 52 31 52H5.57129C2.49438 51.9999 7.13985e-05 49.5056 0 46.4287C1.12084e-06 20.7869 20.7869 -1.12084e-06 46.4287 0H153.571Z" fill="currentColor"/>
      </svg>
      <span>3D Skull Model</span>
    </div>
    <div class="code-sandbox-toggle active" 
         tabindex="0" 
         role="switch" 
         aria-checked="true"></div>
  </div>
</div>

<script data-sandbox-init="sandbox-xlek9wokh">
// Initialize this specific sandbox with options
(function() {
  // Store initialization function globally for reuse
  window.sandboxInitializers = window.sandboxInitializers || {};
  
  window.sandboxInitializers['sandbox-xlek9wokh'] = function() {
    const wrapper = document.querySelector('[data-sandbox-id="sandbox-xlek9wokh"]');
    if (!wrapper || wrapper.codeSandbox) return false;
    
    const options = {
      autoToggleOnScroll: true,
      suspendOnHide: true,
      resetOnShow: false
    };
    
    // Allow content to define custom handlers
    if (window.sandboxHandlers && window.sandboxHandlers['sandbox-xlek9wokh']) {
      Object.assign(options, window.sandboxHandlers['sandbox-xlek9wokh']);
    }
    
    new CodeSandbox(wrapper, options);
    return true;
  };
  
  // Try to initialize immediately
  function tryInit() {
    if (typeof CodeSandbox !== 'undefined') {
      window.sandboxInitializers['sandbox-xlek9wokh']();
      return true;
    }
    return false;
  }
  
  if (!tryInit()) {
    // Wait for CodeSandbox to be available
    const checkInterval = setInterval(() => {
      if (tryInit()) {
        clearInterval(checkInterval);
      }
    }, 100);
    
    // Give up after 5 seconds
    setTimeout(() => clearInterval(checkInterval), 5000);
  }
})();
</script>

                </div>
            </div>
                </article>
                
            </div><!-- .post-content-wrapper -->
        </div><!-- .post-wrapper -->
        
        
        <script>
            // Handle page transition overlay
            document.addEventListener('DOMContentLoaded', function() {
                const overlay = document.querySelector('.page-transition-overlay');
                const body = document.body;
                
                // Add loaded class to body after a short delay
                setTimeout(() => {
                    overlay.classList.add('fade-out');
                    body.classList.add('loaded');
                    
                    // Remove overlay after fade out
                    setTimeout(() => {
                        overlay.remove();
                    }, 1000);
                }, 100);
            });
        </script>
        
        <!-- Cloudflare Web Analytics -->
        <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "e8fdac6a36f74464bcf2d55fbb7f0ca2"}'></script>
        <!-- End Cloudflare Web Analytics -->
    </body>
</html>


        
<script src="/js/device-detection.js"></script>

        
<script src="/js/profile-header-compact.js"></script>

        
<script src="/js/code-sandbox.js"></script>

        <!-- main.js already loaded in head.ejs -->
        

        

        <!-- mobile-tabs.js and sound-effects.js already loaded in head.ejs -->
        <!-- Additional scripts -->
        
        <!-- Cloudflare Web Analytics -->
        <script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "e8fdac6a36f74464bcf2d55fbb7f0ca2"}'></script>
        <!-- End Cloudflare Web Analytics -->
        
        <script>
        // Simple page load handler
        document.body.classList.add('loaded');
        </script>
    </body>
</html>

// Comprehensive scroll fix for all viewports
@use 'variables';

// Desktop (> 1024px)
@media (min-width: calc(variables.$tablet-breakpoint + 1px)) {
  .blog {
    .blog-content {
      // Blog content should not scroll, just contain (unless dynamic content)
      &:not(.has-dynamic-content) {
        overflow: hidden !important;
        height: calc(100dvh - 24px); // Account for margins
        
        .content-inner-wrapper {
          // Inner wrapper should fill parent and not scroll
          height: 100% !important;
          overflow: hidden !important;
          display: flex;
          flex-direction: column;
          
          .tabs-wrapper {
            flex-shrink: 0;
          }
          
          .content-wrapper {
            // Content wrapper handles all scrolling
            flex: 1;
            min-height: 0; // Important for flexbox
            overflow-y: auto !important;
            overflow-x: hidden !important;
            -webkit-overflow-scrolling: touch;
            
            // Scrollbar styling
            &::-webkit-scrollbar {
              width: 6px;
            }
            
            &::-webkit-scrollbar-track {
              background: transparent;
            }
            
            &::-webkit-scrollbar-thumb {
              background-color: rgb(0 0 0 / 20%);
              border-radius: 3px;
              
              @media (prefers-color-scheme: dark) {
                background-color: rgb(255 255 255 / 20%);
              }
            }
          }
        }
      }
    }
  }
}

// Tablet (769px - 1024px)
@media (min-width: calc(variables.$mobile-breakpoint + 1px)) and (max-width: variables.$tablet-breakpoint) {
  .blog {
    .blog-content {
      &:not(.has-dynamic-content) {
        overflow: hidden !important;
        height: calc(100dvh - 24px);
        
        .content-inner-wrapper {
          height: 100% !important;
          overflow: hidden !important;
          display: flex;
          flex-direction: column;
          
          .tabs-wrapper {
            flex-shrink: 0;
          }
          
          .content-wrapper {
            flex: 1;
            min-height: 0;
            overflow-y: auto !important;
            overflow-x: hidden !important;
            -webkit-overflow-scrolling: touch;
          }
        }
      }
    }
  }
}

// Mobile (<= 768px)
@media (max-width: variables.$mobile-breakpoint) {
  // Enable body scroll on mobile - header scrolls away, tabs stick
  html,
  body {
    overflow-x: hidden;
    overflow-y: auto; // Body handles scroll
    overscroll-behavior: none;
    // Extend into safe area
    min-height: calc(100dvh + env(safe-area-inset-bottom, 0px));
  }

  .blog {
    // Blog container doesn't scroll - body does
    min-height: calc(100dvh + env(safe-area-inset-bottom, 0px));
    overflow: visible;

    .blog-header {
      // Header is in document flow - scrolls with content
      height: auto;
      min-height: auto;
      margin-bottom: 0;
      flex-shrink: 0;
    }

    .blog-content {
      // Content fills remaining space
      flex: 1;
      overflow: visible;

      .content-inner-wrapper {
        overflow: visible;

        .content-wrapper {
          overflow: visible;
        }
      }
    }
  }
}

// Fix for dynamic content (posts/projects opened)
.blog-content.has-dynamic-content {
  @media (min-width: calc(variables.$mobile-breakpoint + 1px)) {
    .content-wrapper,
    .content-inner-wrapper {
      height: auto !important;
      min-height: 0 !important;
      overflow: visible !important;
    }
  }
}

// Ensure blog post list items always use the unified text color token
.blog .post-list-item ul li,
.blog .post-list-item ol li,
.blog .blog-list .post-list-item ul li,
.blog .blog-list .post-list-item ol li {
	color: var(--blog-list-text-color) !important;
}

// Unified dynamic scroll behaviour for dynamically loaded blog content
@use 'variables';

:root {
  --blog-dynamic-viewport-height: auto;
}

.blog .blog-content.has-dynamic-content {
  display: flex;
  flex-direction: column;
  position: relative;

  .dynamic-scroll-host {
    flex: 1 1 auto;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    -webkit-overflow-scrolling: touch !important;
    min-height: 0;
    max-height: var(--blog-dynamic-viewport-height, calc(100vh - 140px));
    position: relative;
    opacity: 1 !important;

    &::-webkit-scrollbar {
      width: 6px;
    }

    &::-webkit-scrollbar-track {
      background: transparent;
    }

    &::-webkit-scrollbar-thumb {
      background-color: rgb(0 0 0 / 20%);
      border-radius: 3px;

      @media (prefers-color-scheme: dark) {
        background-color: rgb(255 255 255 / 20%);
      }
    }

    .post-wrapper,
    .substack-post,
    .project-wrapper {
      overflow: visible !important;
      max-height: none !important;
      padding-bottom: 2rem;

      img {
        max-width: 100%;
        height: auto;
      }
    }
  }

  &.has-dynamic-scroll-host {
    height: var(--blog-dynamic-viewport-height, calc(100vh - 12px));
    min-height: var(--blog-dynamic-viewport-height, calc(100vh - 12px));
    max-height: var(--blog-dynamic-viewport-height, calc(100vh - 12px));
  }
}

@media (max-width: variables.$mobile-breakpoint) {
  .blog .blog-content.has-dynamic-content {
    overflow: visible !important;
    height: auto !important;
    min-height: auto !important;
    max-height: none !important;

    .content-wrapper,
    .content-inner-wrapper {
      overflow: visible !important;
      height: auto !important;
      max-height: none !important;
      border-radius: 12px !important;
    }

    .dynamic-scroll-host {
      overflow: visible !important;
      height: auto !important;
      max-height: none !important;

      .post-wrapper,
      .project-wrapper,
      .substack-post {
        overflow: visible !important;
        height: auto !important;
        max-height: none !important;
        padding-bottom: 1rem !important;
        margin-bottom: 0 !important;
      }
    }

    .dynamic-back-button {
      position: absolute !important;
      top: 16px !important;
      left: 16px !important;
      margin: 0 !important;
      display: block !important;
      width: fit-content !important;
    }
  }

  .blog .blog-content .content-inner-wrapper {
    border-radius: 12px !important;
  }
}

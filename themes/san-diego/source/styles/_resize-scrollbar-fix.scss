// Fix for double scrollbar issue when resizing from desktop to mobile
@use 'variables';

// Reset scrollbar behavior on resize transitions
@media (max-width: variables.$mobile-breakpoint) {
  // Ensure body/html don't create extra scrollbars on mobile
  html {
    overflow-x: hidden;
    overflow-y: auto;
  }
  
  body {
    overflow-x: hidden;
    overflow-y: auto;
    // Prevent iOS bounce
    position: relative;
    -webkit-overflow-scrolling: touch;
  }
  
  // Main blog container on mobile should not scroll
  .blog {
    overflow: visible !important;
    height: auto !important;
    min-height: 100dvh;
  }
  
  // Blog content should expand naturally
  .blog-content {
    overflow: visible !important;
    height: auto !important;
    
    // Content wrapper should also expand
    .content-wrapper {
      overflow: visible !important;
      height: auto !important;
      min-height: auto !important;
    }
    
    // Inner wrapper should not scroll
    .content-inner-wrapper {
      overflow: visible !important;
      height: auto !important;
    }
  }
  
  // Tab content containers should not have their own scroll
  #postsContent,
  #projectsContent {
    overflow: visible !important;
    height: auto !important;
    max-height: none !important;
    
    // Ensure proper display when switching tabs
    &[style*="display: none"] {
      // Keep display none when hidden
    }
    
    &[style*="display: block"] {
      overflow: visible !important;
    }
  }
  
  // Fix for tab switching - ensure only one content area is visible
  .tabs-wrapper {
    // Tabs wrapper itself should not cause scrolling
    overflow: visible !important;
    
    // When showing portfolio content
    &[data-active-tab="portfolio"] {
      #projectsContent {
        display: block !important;
        overflow: visible !important;
      }
      #postsContent {
        display: none !important;
      }
    }
    
    // When showing blog content
    &[data-active-tab="blog"] {
      #postsContent {
        display: block !important;
        overflow: visible !important;
      }
      #projectsContent {
        display: none !important;
      }
    }
  }
}

// Desktop to mobile transition fix
@media (max-width: variables.$tablet-breakpoint) {
  // During resize, prevent conflicting overflow rules
  .blog-content {
    // Remove any desktop-specific scroll containers
    &.transitioning-viewport {
      .content-wrapper,
      .content-inner-wrapper {
        overflow: visible !important;
        height: auto !important;
      }
    }
  }
}

// JavaScript hook class for resize detection
.viewport-resizing {
  // Temporarily disable scrollbars during resize
  * {
    scrollbar-width: none !important;
    -ms-overflow-style: none !important;
    
    &::-webkit-scrollbar {
      display: none !important;
    }
  }
}

// Ensure smooth transition between viewport sizes
@media (hover: hover) and (pointer: fine) {
  // Desktop/laptop with mouse
  .blog-content {
    transition: none; // Disable transitions during resize
  }
}

// Fix for Works/portfolio specific scrolling issues
#projectsContent {
  // Portfolio grid should not create its own scroll context on mobile
  @media (max-width: variables.$mobile-breakpoint) {
    overflow: visible !important;
    
    .portfolio-featured-grid,
    .portfolio-list {
      overflow: visible !important;
      
      // Ensure items don't cause overflow
      .portfolio-item {
        overflow: hidden; // But individual items should clip content
      }
    }
  }
  
  // On tablet/desktop, contain the content properly
  @media (min-width: calc(variables.$mobile-breakpoint + 1px)) {
    // When displayed, ensure content doesn't escape
    &[style*="display: block"] {
      overflow: hidden !important;
      contain: layout style;
      
      // Inner content can scroll if needed
      .portfolio-featured-grid,
      .portfolio-list {
        overflow-x: hidden;
        overflow-y: auto;
        max-height: 100%;
      }
    }
  }
}

// Additional safety for dynamic content
.has-dynamic-content {
  @media (max-width: variables.$mobile-breakpoint) {
    // Ensure dynamic content doesn't create scrollbars
    .post-wrapper,
    .project-wrapper,
    .content-inner-wrapper {
      overflow: visible !important;
      height: auto !important;
    }
  }
}
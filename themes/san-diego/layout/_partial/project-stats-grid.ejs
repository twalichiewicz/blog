<%
// Project Stats Grid Component
// Displays project metadata in a high-density grid format
// 
// Expected data structure:
// stats: [
//   { label: 'Role', value: 'Lead Designer' },
//   { label: 'Timeline', value: '6 months' },
//   { label: 'Team', value: ['1 Designer', '3 Engineers', '1 PM'], type: 'list' },
//   { label: 'Impact', value: '90% reduction', type: 'highlight' },
//   { label: 'Skills', value: ['Design Systems', 'Prototyping', 'Research'], type: 'tags' }
// ]

const stats = locals.stats || [];
const variant = locals.variant || ''; // 'compact', 'two-col', 'three-col'
const className = locals.className || '';

// Determine grid class based on number of items or explicit variant
let gridClass = 'project-stats-grid';
if (variant) {
  gridClass += ` project-stats-grid--${variant}`;
} else if (stats.length === 2) {
  gridClass += ' project-stats-grid--two-col';
} else if (stats.length === 3 || stats.length === 6) {
  gridClass += ' project-stats-grid--three-col';
}

if (className) {
  gridClass += ` ${className}`;
}
%>

<% if (stats && stats.length > 0) { %>
<div class="<%- gridClass %>">
  <% stats.forEach(function(stat, index) { 
    if (!stat.label || !stat.value) return;
    
    // Determine value class based on type
    let valueClass = 'stat-value';
    if (stat.type === 'list') {
      valueClass += ' stat-value--list';
    } else if (stat.type === 'highlight') {
      valueClass += ' stat-value--highlight';
    } else if (stat.type === 'tags') {
      valueClass += ' stat-value--tags';
    }
    
    // Add spanning class for items that should span columns
    let itemClass = 'project-stat-item';
    if (stat.span === 2) {
      itemClass += ' stat-span-2';
    } else if (stat.span === 3) {
      itemClass += ' stat-span-3';
    }
  %>
    <div class="<%- itemClass %>">
      <div class="stat-label"><%- stat.label %></div>
      <div class="<%- valueClass %>">
        <% if (stat.type === 'list' && Array.isArray(stat.value)) { %>
          <ul>
            <% stat.value.forEach(function(item) { 
              // Check if this is a team member with role description
              const dashIndex = item.indexOf(' - ');
              if (stat.label === 'Team' && dashIndex > -1) {
                const member = item.substring(0, dashIndex);
                const role = item.substring(dashIndex + 3);
            %>
              <li>
                <%- member %>
                <span class="team-member-role"><%- role %></span>
              </li>
            <% } else { %>
              <li><%- item %></li>
            <% } 
            }) %>
          </ul>
        <% } else if (stat.type === 'tags' && Array.isArray(stat.value)) { %>
          <% stat.value.forEach(function(tag) { %>
            <span class="stat-tag"><%- tag %></span>
          <% }) %>
        <% } else { %>
          <%- stat.value %>
        <% } %>
      </div>
    </div>
  <% }) %>
</div>
<% } %>
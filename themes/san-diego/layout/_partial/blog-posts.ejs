<div id="postsContent" class="blog-list" role="tabpanel" aria-labelledby="tab-blog">
    <div class="column-title blog-column-title">Posts</div>
    
    <!-- Add search bar -->
    <div class="search-container">
        <div class="search-input-wrapper">
            <div class="search-icon">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M21 21l-4.35-4.35"/>
                    <path d="M15.5 10.5a5 5 0 1 0-10 0 5 5 0 0 0 10 0z"/>
                </svg>
            </div>
            <input type="text" id="postSearch" placeholder="Search words..." class="search-input" aria-label="Search blog posts">
            <button class="search-clear" aria-label="Clear search" style="display: none;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <line x1="18" y1="6" x2="6" y2="18"/>
                    <line x1="6" y1="6" x2="18" y2="18"/>
                </svg>
            </button>
        </div>
        <button class="posts-only-button" data-filter="posts">Posts only</button>
    </div>
    
    <% if (blogPosts.length > 0) { %>
        <% blogPosts.forEach(function(post, index) { %>
            <% 
            // Generate unique post ID from title or use index
            const postId = 'post-' + (post.slug || post.title.toLowerCase().replace(/[^\w]+/g, '-') || index);
            
            // Determine if this is a long-form post (has <a> in h3 and long: true)
            const isLongPost = post.long === true && !post.type;
            const classNames = [];
            if (post.type === 'link') {
                classNames.push('post-link');
            }
            if (isLongPost) {
                classNames.push('post-long');
            }
            %>
            <% 
            // Determine post type for styling
            const postType = post.type === 'link' ? 'Link' : (post.short ? 'Musing' : 'Post');
            const isRegularPost = !post.type && !post.short;
            %>
            
            <a href="<%- url_for(post.path) %>" class="post-link-wrapper no-external-indicators">
                <article class="post-list-item <%= classNames.join(' ') %>" id="<%= postId %>">
                    <div class="post-byline" data-type="<%= postType %>">
                        <%= date(post.date, 'MMMM D, YYYY') %>
                    </div>
                    
                    <% if (isRegularPost) { %>
                        <h3 class="preview-title"><%= post.title %></h3>
                        <% if (post.subtitle || post.excerpt) { %>
                            <p class="preview-excerpt"><%- post.subtitle || post.excerpt %></p>
                        <% } %>
                        <div class="preview-metadata">
                            <% 
                            // Calculate reading time
                            let wordCount = 0;
                            if (post._content) {
                                const content = post._content.replace(/<\/?[^>]+(>|$)/g, '');
                                wordCount = content.split(/\s+/).filter(word => word.length > 0).length;
                            }
                            const readingTime = Math.max(1, Math.ceil(wordCount / 200));
                            %>
                            <span class="preview-reading-time"><%= readingTime %> min read</span>
                        </div>
                    <% } else if (post.type === 'link') { %>
                        <h3><%= post.title %></h3>
                        <% if (post.content) { %>
                            <% 
                            // Strip script tags from link post content to prevent HTML breaking
                            const cleanContent = post.content
                                .replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi, '')
                                .replace(/<style\b[^<]*(?:(?!<\/style>)<[^<]*)*<\/style>/gi, '');
                            %>
                            <p><%- cleanContent %></p>
                        <% } %>
                        <div class="link-share no-external-indicators">
                            <a href="<%= post.url %>" target="_blank" rel="noopener" class="post-link-wrapper" onclick="event.stopPropagation();">
                                <div class="link-text-group">
                                    <%= new URL(post.url).hostname %>
                                </div>
                                <span class="external-icon">â†—</span>
                            </a>
                        </div>
                    <% } else if (post.short) { %>
                        <%- post.content %>
                    <% } %>
                </article>
            </a>
            <% if (index < blogPosts.length - 1) { %>
                <hr class="post-separator">
            <% } %>
        <% }) %>
    <% } else { %>
        <%- partial('_partial/loading-skull') %>
    <% } %>
</div>